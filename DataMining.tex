\documentclass[11pt]{article}

    \usepackage[breakable]{tcolorbox}
    \usepackage{parskip} % Stop auto-indenting (to mimic markdown behaviour)
    
    \usepackage{iftex}
    \ifPDFTeX
    	\usepackage[T1]{fontenc}
    	\usepackage{mathpazo}
    \else
    	\usepackage{fontspec}
    \fi

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % Maintain compatibility with old templates. Remove in nbconvert 6.0
    \let\Oldincludegraphics\includegraphics
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionFormat{nocaption}{}
    \captionsetup{format=nocaption,aboveskip=0pt,belowskip=0pt}

    \usepackage[Export]{adjustbox} % Used to constrain images to a maximum size
    \adjustboxset{max size={0.9\linewidth}{0.9\paperheight}}
    \usepackage{float}
    \floatplacement{figure}{H} % forces figures to be placed at the correct location
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range
    \makeatletter % fix for grffile with XeLaTeX
    \def\Gread@@xetex#1{%
      \IfFileExists{"\Gin@base".bb}%
      {\Gread@eps{\Gin@base.bb}}%
      {\Gread@@xetex@aux#1}%
    }
    \makeatother

    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    % The default LaTeX title has an obnoxious amount of whitespace. By default,
    % titling removes some of it. It also provides customization options.
    \usepackage{titling}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    \usepackage{mathrsfs}
    

    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}
    \definecolor{ansi-default-inverse-fg}{HTML}{FFFFFF}
    \definecolor{ansi-default-inverse-bg}{HTML}{000000}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatibility definitions
    \def\gt{>}
    \def\lt{<}
    \let\Oldtex\TeX
    \let\Oldlatex\LaTeX
    \renewcommand{\TeX}{\textrm{\Oldtex}}
    \renewcommand{\LaTeX}{\textrm{\Oldlatex}}
    % Document parameters
    % Document title
    \title{DataMining}
    
    
    
    
    
% Pygments definitions
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % For linebreaks inside Verbatim environment from package fancyvrb. 
    \makeatletter
        \newbox\Wrappedcontinuationbox 
        \newbox\Wrappedvisiblespacebox 
        \newcommand*\Wrappedvisiblespace {\textcolor{red}{\textvisiblespace}} 
        \newcommand*\Wrappedcontinuationsymbol {\textcolor{red}{\llap{\tiny$\m@th\hookrightarrow$}}} 
        \newcommand*\Wrappedcontinuationindent {3ex } 
        \newcommand*\Wrappedafterbreak {\kern\Wrappedcontinuationindent\copy\Wrappedcontinuationbox} 
        % Take advantage of the already applied Pygments mark-up to insert 
        % potential linebreaks for TeX processing. 
        %        {, <, #, %, $, ' and ": go to next line. 
        %        _, }, ^, &, >, - and ~: stay at end of broken line. 
        % Use of \textquotesingle for straight quote. 
        \newcommand*\Wrappedbreaksatspecials {% 
            \def\PYGZus{\discretionary{\char`\_}{\Wrappedafterbreak}{\char`\_}}% 
            \def\PYGZob{\discretionary{}{\Wrappedafterbreak\char`\{}{\char`\{}}% 
            \def\PYGZcb{\discretionary{\char`\}}{\Wrappedafterbreak}{\char`\}}}% 
            \def\PYGZca{\discretionary{\char`\^}{\Wrappedafterbreak}{\char`\^}}% 
            \def\PYGZam{\discretionary{\char`\&}{\Wrappedafterbreak}{\char`\&}}% 
            \def\PYGZlt{\discretionary{}{\Wrappedafterbreak\char`\<}{\char`\<}}% 
            \def\PYGZgt{\discretionary{\char`\>}{\Wrappedafterbreak}{\char`\>}}% 
            \def\PYGZsh{\discretionary{}{\Wrappedafterbreak\char`\#}{\char`\#}}% 
            \def\PYGZpc{\discretionary{}{\Wrappedafterbreak\char`\%}{\char`\%}}% 
            \def\PYGZdl{\discretionary{}{\Wrappedafterbreak\char`\$}{\char`\$}}% 
            \def\PYGZhy{\discretionary{\char`\-}{\Wrappedafterbreak}{\char`\-}}% 
            \def\PYGZsq{\discretionary{}{\Wrappedafterbreak\textquotesingle}{\textquotesingle}}% 
            \def\PYGZdq{\discretionary{}{\Wrappedafterbreak\char`\"}{\char`\"}}% 
            \def\PYGZti{\discretionary{\char`\~}{\Wrappedafterbreak}{\char`\~}}% 
        } 
        % Some characters . , ; ? ! / are not pygmentized. 
        % This macro makes them "active" and they will insert potential linebreaks 
        \newcommand*\Wrappedbreaksatpunct {% 
            \lccode`\~`\.\lowercase{\def~}{\discretionary{\hbox{\char`\.}}{\Wrappedafterbreak}{\hbox{\char`\.}}}% 
            \lccode`\~`\,\lowercase{\def~}{\discretionary{\hbox{\char`\,}}{\Wrappedafterbreak}{\hbox{\char`\,}}}% 
            \lccode`\~`\;\lowercase{\def~}{\discretionary{\hbox{\char`\;}}{\Wrappedafterbreak}{\hbox{\char`\;}}}% 
            \lccode`\~`\:\lowercase{\def~}{\discretionary{\hbox{\char`\:}}{\Wrappedafterbreak}{\hbox{\char`\:}}}% 
            \lccode`\~`\?\lowercase{\def~}{\discretionary{\hbox{\char`\?}}{\Wrappedafterbreak}{\hbox{\char`\?}}}% 
            \lccode`\~`\!\lowercase{\def~}{\discretionary{\hbox{\char`\!}}{\Wrappedafterbreak}{\hbox{\char`\!}}}% 
            \lccode`\~`\/\lowercase{\def~}{\discretionary{\hbox{\char`\/}}{\Wrappedafterbreak}{\hbox{\char`\/}}}% 
            \catcode`\.\active
            \catcode`\,\active 
            \catcode`\;\active
            \catcode`\:\active
            \catcode`\?\active
            \catcode`\!\active
            \catcode`\/\active 
            \lccode`\~`\~ 	
        }
    \makeatother

    \let\OriginalVerbatim=\Verbatim
    \makeatletter
    \renewcommand{\Verbatim}[1][1]{%
        %\parskip\z@skip
        \sbox\Wrappedcontinuationbox {\Wrappedcontinuationsymbol}%
        \sbox\Wrappedvisiblespacebox {\FV@SetupFont\Wrappedvisiblespace}%
        \def\FancyVerbFormatLine ##1{\hsize\linewidth
            \vtop{\raggedright\hyphenpenalty\z@\exhyphenpenalty\z@
                \doublehyphendemerits\z@\finalhyphendemerits\z@
                \strut ##1\strut}%
        }%
        % If the linebreak is at a space, the latter will be displayed as visible
        % space at end of first line, and a continuation symbol starts next line.
        % Stretch/shrink are however usually zero for typewriter font.
        \def\FV@Space {%
            \nobreak\hskip\z@ plus\fontdimen3\font minus\fontdimen4\font
            \discretionary{\copy\Wrappedvisiblespacebox}{\Wrappedafterbreak}
            {\kern\fontdimen2\font}%
        }%
        
        % Allow breaks at special characters using \PYG... macros.
        \Wrappedbreaksatspecials
        % Breaks at punctuation characters . , ; ? ! and / need catcode=\active 	
        \OriginalVerbatim[#1,codes*=\Wrappedbreaksatpunct]%
    }
    \makeatother

    % Exact colors from NB
    \definecolor{incolor}{HTML}{303F9F}
    \definecolor{outcolor}{HTML}{D84315}
    \definecolor{cellborder}{HTML}{CFCFCF}
    \definecolor{cellbackground}{HTML}{F7F7F7}
    
    % prompt
    \makeatletter
    \newcommand{\boxspacing}{\kern\kvtcb@left@rule\kern\kvtcb@boxsep}
    \makeatother
    \newcommand{\prompt}[4]{
        \ttfamily\llap{{\color{#2}[#3]:\hspace{3pt}#4}}\vspace{-\baselineskip}
    }
    

    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

\begin{document}
    
    \maketitle
    
    

    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{os}
\PY{k+kn}{import} \PY{n+nn}{tensorflow} \PY{k}{as} \PY{n+nn}{tf}

\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{models} \PY{k}{import} \PY{n}{Sequential}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers} \PY{k}{import} \PY{n}{Convolution2D}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers} \PY{k}{import} \PY{n}{MaxPooling2D}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers} \PY{k}{import} \PY{n}{Flatten}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers} \PY{k}{import} \PY{n}{Dense}

\PY{n}{batchSize} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{epochs} \PY{o}{=} \PY{l+m+mi}{10}
\PY{n}{steps} \PY{o}{=} \PY{l+m+mi}{200}
\PY{n}{enumEpochs} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{epochs}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}

\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Imports!}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{classifier}\PY{o}{=}\PY{n}{Sequential}\PY{p}{(}\PY{p}{)}   \PY{c+c1}{\PYZsh{} Intialializing CNN}

\PY{c+c1}{\PYZsh{} Convolution Step}
\PY{n}{classifier}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Convolution2D}\PY{p}{(}\PY{l+m+mi}{32}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{,} 
                             \PY{n}{input\PYZus{}shape} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{128}\PY{p}{,}\PY{l+m+mi}{128}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}\PY{p}{,} 
                             \PY{n}{activation} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{relu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)} \PY{c+c1}{\PYZsh{} order of  input\PYZus{}shape for tensorflow backend}

\PY{c+c1}{\PYZsh{}Pooling Step}
\PY{n}{classifier}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{MaxPooling2D}\PY{p}{(}\PY{n}{pool\PYZus{}size} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}\PY{p}{)}

\PY{c+c1}{\PYZsh{}Flattening Step}
\PY{n}{classifier}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Flatten}\PY{p}{(}\PY{p}{)}\PY{p}{)} 

\PY{c+c1}{\PYZsh{}Full Connection Step}
\PY{n}{classifier}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dense}\PY{p}{(}\PY{l+m+mi}{128}\PY{p}{,}\PY{n}{activation} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{relu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
\PY{n}{classifier}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dense}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{activation} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sigmoid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)} \PY{c+c1}{\PYZsh{}output layer }

\PY{c+c1}{\PYZsh{}Compiling CNN}
\PY{n}{classifier}\PY{o}{.}\PY{n}{compile}\PY{p}{(}\PY{n}{optimizer} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{adam}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{loss} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{binary\PYZus{}crossentropy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{metrics} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{accuracy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{classifier}\PY{o}{.}\PY{n}{save}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{F:/Workspace/Test/checkpoints/myModel.h5}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Input!}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{preprocessing}\PY{n+nn}{.}\PY{n+nn}{image} \PY{k}{import} \PY{n}{ImageDataGenerator}

\PY{n}{path}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{F:/Workspace/Test/input/training\PYZus{}set}\PY{l+s+s2}{\PYZdq{}}

\PY{n}{train\PYZus{}datagen} \PY{o}{=} \PY{n}{ImageDataGenerator}\PY{p}{(}\PY{n}{rescale}\PY{o}{=}\PY{l+m+mf}{1.}\PY{o}{/}\PY{l+m+mi}{255}\PY{p}{)}

\PY{n}{test\PYZus{}datagen} \PY{o}{=} \PY{n}{ImageDataGenerator}\PY{p}{(}\PY{n}{rescale}\PY{o}{=}\PY{l+m+mf}{1.}\PY{o}{/}\PY{l+m+mi}{255}\PY{p}{)}


\PY{n}{training\PYZus{}set} \PY{o}{=} \PY{n}{train\PYZus{}datagen}\PY{o}{.}\PY{n}{flow\PYZus{}from\PYZus{}directory}\PY{p}{(} \PY{n}{path}\PY{p}{,}
                                                    \PY{n}{target\PYZus{}size}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{128}\PY{p}{,} \PY{l+m+mi}{128}\PY{p}{)}\PY{p}{,}
                                                    \PY{n}{batch\PYZus{}size}\PY{o}{=}\PY{n}{batchSize}\PY{p}{,}
                                                    \PY{n}{class\PYZus{}mode}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{binary}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Validation!}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{path}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{F:/Workspace/Test/input/validation}\PY{l+s+s2}{\PYZdq{}}

\PY{n}{test\PYZus{}set} \PY{o}{=} \PY{n}{test\PYZus{}datagen}\PY{o}{.}\PY{n}{flow\PYZus{}from\PYZus{}directory}\PY{p}{(}
                                              \PY{n}{path}\PY{p}{,}
                                              \PY{n}{target\PYZus{}size}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{128}\PY{p}{,}\PY{l+m+mi}{128}\PY{p}{)}\PY{p}{,}
                                              \PY{n}{batch\PYZus{}size}\PY{o}{=}\PY{n}{batchSize}\PY{p}{,}
                                              \PY{n}{class\PYZus{}mode}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{binary}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}





\PY{n}{history} \PY{o}{=} \PY{n}{classifier}\PY{o}{.}\PY{n}{fit\PYZus{}generator}\PY{p}{(}
        \PY{n}{training\PYZus{}set}\PY{p}{,}
        \PY{n}{steps\PYZus{}per\PYZus{}epoch}\PY{o}{=}\PY{n}{steps}\PY{p}{,}
        \PY{n}{epochs}\PY{o}{=}\PY{n}{epochs}\PY{p}{,}
        \PY{n}{validation\PYZus{}data}\PY{o}{=}\PY{n}{test\PYZus{}set}\PY{p}{,}
        \PY{n}{validation\PYZus{}steps}\PY{o}{=}\PY{n}{steps}\PY{p}{,} 
        \PY{n}{callbacks} \PY{o}{=} \PY{p}{[}\PY{n}{cp\PYZus{}callback}\PY{p}{]}\PY{p}{)}

\PY{n}{acc} \PY{o}{=} \PY{n}{history}\PY{o}{.}\PY{n}{history}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{accuracy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{val\PYZus{}acc} \PY{o}{=} \PY{n}{history}\PY{o}{.}\PY{n}{history}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{val\PYZus{}accuracy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{loss} \PY{o}{=} \PY{n}{history}\PY{o}{.}\PY{n}{history}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{loss}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{val\PYZus{}loss} \PY{o}{=} \PY{n}{history}\PY{o}{.}\PY{n}{history}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{val\PYZus{}loss}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}



\PY{c+c1}{\PYZsh{} plt.plot(enumEpochs, acc, \PYZsq{}b\PYZsq{}, label=\PYZsq{}Training\PYZsq{})}
\PY{c+c1}{\PYZsh{} plt.plot(enumEpochs, val\PYZus{}acc, \PYZsq{}r\PYZsq{}, label=\PYZsq{}Validation\PYZsq{})}
\PY{c+c1}{\PYZsh{} plt.title(\PYZsq{}Accuracy\PYZsq{})}
\PY{c+c1}{\PYZsh{} plt.legend()}
\PY{c+c1}{\PYZsh{} plt.figure()}

\PY{c+c1}{\PYZsh{} plt.show()}

\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Teste!}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

\PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
\PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline

\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{roc\PYZus{}curve}\PY{p}{,}\PY{n}{roc\PYZus{}auc\PYZus{}score}

\PY{n}{path} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{F:/Workspace/Test/input/test}\PY{l+s+s2}{\PYZdq{}}
\PY{n}{test\PYZus{}generator} \PY{o}{=} \PY{n}{test\PYZus{}datagen}\PY{o}{.}\PY{n}{flow\PYZus{}from\PYZus{}directory}\PY{p}{(}
                                              \PY{n}{path}\PY{p}{,}
                                              \PY{n}{target\PYZus{}size}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{128}\PY{p}{,}\PY{l+m+mi}{128}\PY{p}{)}\PY{p}{,}
                                              \PY{n}{batch\PYZus{}size}\PY{o}{=}\PY{n}{batchSize}\PY{p}{,}
                                              \PY{n}{class\PYZus{}mode}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{binary}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{}predictions =  classifier.predict\PYZus{}generator(test\PYZus{}generator, steps=steps)}
\PY{n}{trueValues} \PY{o}{=} \PY{n}{test\PYZus{}generator}\PY{o}{.}\PY{n}{classes}

\PY{c+c1}{\PYZsh{}first seperate the `test images` and `test labels`}
\PY{c+c1}{\PYZsh{}test\PYZus{}images,test\PYZus{}labels = next(test\PYZus{}generator)}

\PY{c+c1}{\PYZsh{}get the class indices}
\PY{n+nb}{print}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{trueValues}\PY{p}{)}\PY{p}{)}
\PY{c+c1}{\PYZsh{}test\PYZus{}labels = test\PYZus{}labels[:,0]  \PYZsh{}this should give you array of labels}

\PY{n}{predictions} \PY{o}{=} \PY{n}{classifier}\PY{o}{.}\PY{n}{predict\PYZus{}generator}\PY{p}{(}\PY{n}{test\PYZus{}generator}\PY{p}{,}\PY{n}{steps} \PY{o}{=} \PY{l+m+mi}{609}\PY{p}{,}\PY{n}{verbose}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}

\PY{c+c1}{\PYZsh{}trueValues = len(predictions)}
\PY{c+c1}{\PYZsh{}predictions[:,0]}

\PY{n}{fpr}\PY{p}{,} \PY{n}{tpr}\PY{p}{,} \PY{n}{thresholds} \PY{o}{=} \PY{n}{roc\PYZus{}curve} \PY{p}{(}\PY{n}{trueValues} \PY{p}{,} \PY{n}{predictions}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{fpr}\PY{p}{,}\PY{n}{tpr}\PY{p}{)} 
\PY{n}{plt}\PY{o}{.}\PY{n}{axis}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)} 
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{False Positive Rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} 
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{True Positive Rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} 
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Done!}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{tensorflow} \PY{k}{as} \PY{n+nn}{tf}

\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{models} \PY{k}{import} \PY{n}{Sequential}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers} \PY{k}{import} \PY{n}{Convolution2D}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers} \PY{k}{import} \PY{n}{MaxPooling2D}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers} \PY{k}{import} \PY{n}{Flatten}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers} \PY{k}{import} \PY{n}{Dense}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras} \PY{k}{import} \PY{n}{applications}

\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers} \PY{k}{import} \PY{n}{Input}\PY{p}{,} \PY{n}{Flatten}\PY{p}{,} \PY{n}{Dense}
\PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{models} \PY{k}{import} \PY{n}{Model}

\PY{k+kn}{from} \PY{n+nn}{datetime} \PY{k}{import} \PY{n}{datetime}

\PY{k+kn}{import} \PY{n+nn}{os}

\PY{n}{now} \PY{o}{=} \PY{n}{datetime}\PY{o}{.}\PY{n}{now}\PY{p}{(}\PY{p}{)}
\PY{n}{timestamp} \PY{o}{=} \PY{n}{datetime}\PY{o}{.}\PY{n}{timestamp}\PY{p}{(}\PY{n}{now}\PY{p}{)}

\PY{n}{dt\PYZus{}string} \PY{o}{=} \PY{n}{now}\PY{o}{.}\PY{n}{strftime}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{m/}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{Y }\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{H:}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{M:}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{S}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Starting date and time =}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{dt\PYZus{}string}\PY{p}{)}

\PY{n}{classifier}\PY{o}{=}\PY{n}{tf}\PY{o}{.}\PY{n}{keras}\PY{o}{.}\PY{n}{Sequential}\PY{p}{(}\PY{p}{)}   \PY{c+c1}{\PYZsh{} Intialializing CNN}

\PY{n}{shape} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{244}\PY{p}{,} \PY{l+m+mi}{244}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{)}
\PY{n}{vggModel}\PY{o}{=}\PY{n}{tf}\PY{o}{.}\PY{n}{keras}\PY{o}{.}\PY{n}{applications}\PY{o}{.}\PY{n}{VGG16}\PY{p}{(}\PY{n}{input\PYZus{}shape}\PY{o}{=}\PY{n}{shape}\PY{p}{,}
                                               \PY{n}{include\PYZus{}top}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,}
                                               \PY{n}{weights}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{imagenet}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{classifier}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{vggModel}\PY{p}{)}

\PY{c+c1}{\PYZsh{}Flattening Step}
\PY{n}{classifier}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Flatten}\PY{p}{(}\PY{p}{)}\PY{p}{)} 

\PY{c+c1}{\PYZsh{}Full Connection Step}
\PY{n}{classifier}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dense}\PY{p}{(}\PY{l+m+mi}{4096}\PY{p}{,}\PY{n}{activation} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{relu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
\PY{n}{classifier}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dense}\PY{p}{(}\PY{l+m+mi}{4096}\PY{p}{,}\PY{n}{activation} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{relu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}  
\PY{n}{classifier}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dense}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{activation} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{softmax}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}

\PY{c+c1}{\PYZsh{}Compiling CNN}
\PY{n}{classifier}\PY{o}{.}\PY{n}{compile}\PY{p}{(}\PY{n}{optimizer} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{adam}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{loss} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{binary\PYZus{}crossentropy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{metrics} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{accuracy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}

\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{preprocessing}\PY{n+nn}{.}\PY{n+nn}{image} \PY{k}{import} \PY{n}{ImageDataGenerator}

\PY{n}{path}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{F:/Workspace/Test/input/training\PYZus{}set}\PY{l+s+s2}{\PYZdq{}}

\PY{c+c1}{\PYZsh{} train\PYZus{}datagen = ImageDataGenerator(}
\PY{c+c1}{\PYZsh{}         rescale=1./255,}
\PY{c+c1}{\PYZsh{}         shear\PYZus{}range=0.2,}
\PY{c+c1}{\PYZsh{}         zoom\PYZus{}range=0.2,}
\PY{c+c1}{\PYZsh{}         horizontal\PYZus{}flip=True)}

\PY{c+c1}{\PYZsh{} test\PYZus{}datagen = ImageDataGenerator(}
\PY{c+c1}{\PYZsh{}         rescale=1./255,}
\PY{c+c1}{\PYZsh{}         shear\PYZus{}range=0.2,}
\PY{c+c1}{\PYZsh{}         zoom\PYZus{}range=0.2,}
\PY{c+c1}{\PYZsh{}         horizontal\PYZus{}flip=True)}

\PY{n}{epochs} \PY{o}{=} \PY{l+m+mi}{3}
\PY{n}{steps} \PY{o}{=} \PY{l+m+mi}{10}
\PY{n}{enumEpochs} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{epochs}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
\PY{c+c1}{\PYZsh{}print(enumEpochs)}

\PY{n}{train\PYZus{}datagen} \PY{o}{=} \PY{n}{ImageDataGenerator}\PY{p}{(}\PY{n}{rescale}\PY{o}{=}\PY{l+m+mf}{1.}\PY{o}{/}\PY{l+m+mi}{255}\PY{p}{)}

\PY{n}{test\PYZus{}datagen} \PY{o}{=} \PY{n}{ImageDataGenerator}\PY{p}{(}\PY{n}{rescale}\PY{o}{=}\PY{l+m+mf}{1.}\PY{o}{/}\PY{l+m+mi}{255}\PY{p}{)}


\PY{n}{training\PYZus{}set} \PY{o}{=} \PY{n}{train\PYZus{}datagen}\PY{o}{.}\PY{n}{flow\PYZus{}from\PYZus{}directory}\PY{p}{(} \PY{n}{path}\PY{p}{,}
                                                    \PY{n}{target\PYZus{}size}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{244}\PY{p}{,} \PY{l+m+mi}{244}\PY{p}{)}\PY{p}{,}
                                                    \PY{n}{batch\PYZus{}size}\PY{o}{=}\PY{l+m+mi}{32}\PY{p}{,}
                                                    \PY{n}{class\PYZus{}mode}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{binary}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Validation!}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{path}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{F:/Workspace/Test/input/validation}\PY{l+s+s2}{\PYZdq{}}

\PY{n}{test\PYZus{}set} \PY{o}{=} \PY{n}{test\PYZus{}datagen}\PY{o}{.}\PY{n}{flow\PYZus{}from\PYZus{}directory}\PY{p}{(}
                                              \PY{n}{path}\PY{p}{,}
                                              \PY{n}{target\PYZus{}size}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{244}\PY{p}{,}\PY{l+m+mi}{244}\PY{p}{)}\PY{p}{,}
                                              \PY{n}{batch\PYZus{}size}\PY{o}{=}\PY{l+m+mi}{32}\PY{p}{,}
                                              \PY{n}{class\PYZus{}mode}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{binary}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                                              

\PY{c+c1}{\PYZsh{}Quando testar no servidor, alterar para mais épocas e passos}
\PY{n}{history} \PY{o}{=} \PY{n}{classifier}\PY{o}{.}\PY{n}{fit\PYZus{}generator}\PY{p}{(}
        \PY{n}{training\PYZus{}set}\PY{p}{,}
        \PY{n}{steps\PYZus{}per\PYZus{}epoch}\PY{o}{=}\PY{n}{steps}\PY{p}{,}
        \PY{n}{epochs}\PY{o}{=}\PY{n}{epochs}\PY{p}{,}
        \PY{n}{validation\PYZus{}data}\PY{o}{=}\PY{n}{test\PYZus{}set}\PY{p}{,}
        \PY{n}{validation\PYZus{}steps}\PY{o}{=}\PY{n}{steps}\PY{p}{)}


\PY{n}{now} \PY{o}{=} \PY{n}{datetime}\PY{o}{.}\PY{n}{now}\PY{p}{(}\PY{p}{)}
\PY{n}{timestamp} \PY{o}{=} \PY{n}{datetime}\PY{o}{.}\PY{n}{timestamp}\PY{p}{(}\PY{n}{now}\PY{p}{)}

\PY{n}{dt\PYZus{}string} \PY{o}{=} \PY{n}{now}\PY{o}{.}\PY{n}{strftime}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{m/}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{Y }\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{H:}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{M:}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{S}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Finish date and time =}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{dt\PYZus{}string}\PY{p}{)}

\PY{c+c1}{\PYZsh{} acc = history.history[\PYZsq{}accuracy\PYZsq{}]}
\PY{c+c1}{\PYZsh{} val\PYZus{}acc = history.history[\PYZsq{}val\PYZus{}accuracy\PYZsq{}]}
\PY{c+c1}{\PYZsh{} loss = history.history[\PYZsq{}loss\PYZsq{}]}
\PY{c+c1}{\PYZsh{} val\PYZus{}loss = history.history[\PYZsq{}val\PYZus{}loss\PYZsq{}]}

\PY{c+c1}{\PYZsh{} import matplotlib.pyplot as plt}
\PY{c+c1}{\PYZsh{} \PYZpc{}matplotlib inline}

\PY{c+c1}{\PYZsh{} plt.plot(enumEpochs, acc, \PYZsq{}b\PYZsq{}, label=\PYZsq{}Training\PYZsq{})}
\PY{c+c1}{\PYZsh{} plt.plot(enumEpochs, val\PYZus{}acc, \PYZsq{}r\PYZsq{}, label=\PYZsq{}Validation\PYZsq{})}
\PY{c+c1}{\PYZsh{} plt.title(\PYZsq{}Accuracy\PYZsq{})}
\PY{c+c1}{\PYZsh{} plt.legend()}
\PY{c+c1}{\PYZsh{} plt.figure()}

\PY{c+c1}{\PYZsh{} plt.show()}

\PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
\PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline

\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{roc\PYZus{}curve}\PY{p}{,}\PY{n}{roc\PYZus{}auc\PYZus{}score}

\PY{n}{path} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{F:/Workspace/Test/input/test}\PY{l+s+s2}{\PYZdq{}}
\PY{n}{test\PYZus{}generator} \PY{o}{=} \PY{n}{test\PYZus{}datagen}\PY{o}{.}\PY{n}{flow\PYZus{}from\PYZus{}directory}\PY{p}{(}
                                              \PY{n}{path}\PY{p}{,}
                                              \PY{n}{target\PYZus{}size}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{128}\PY{p}{,}\PY{l+m+mi}{128}\PY{p}{)}\PY{p}{,}
                                              \PY{n}{batch\PYZus{}size}\PY{o}{=}\PY{n}{batchSize}\PY{p}{,}
                                              \PY{n}{class\PYZus{}mode}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{binary}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{}predictions =  classifier.predict\PYZus{}generator(test\PYZus{}generator, steps=steps)}
\PY{n}{trueValues} \PY{o}{=} \PY{n}{test\PYZus{}generator}\PY{o}{.}\PY{n}{classes}

\PY{c+c1}{\PYZsh{}first seperate the `test images` and `test labels`}
\PY{c+c1}{\PYZsh{}test\PYZus{}images,test\PYZus{}labels = next(test\PYZus{}generator)}

\PY{c+c1}{\PYZsh{}get the class indices}
\PY{n+nb}{print}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{trueValues}\PY{p}{)}\PY{p}{)}
\PY{c+c1}{\PYZsh{}test\PYZus{}labels = test\PYZus{}labels[:,0]  \PYZsh{}this should give you array of labels}

\PY{n}{predictions} \PY{o}{=} \PY{n}{classifier}\PY{o}{.}\PY{n}{predict\PYZus{}generator}\PY{p}{(}\PY{n}{test\PYZus{}generator}\PY{p}{,}\PY{n}{steps} \PY{o}{=} \PY{l+m+mi}{609}\PY{p}{,}\PY{n}{verbose}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}

\PY{c+c1}{\PYZsh{}trueValues = len(predictions)}
\PY{c+c1}{\PYZsh{}predictions[:,0]}

\PY{n}{fpr}\PY{p}{,} \PY{n}{tpr}\PY{p}{,} \PY{n}{thresholds} \PY{o}{=} \PY{n}{roc\PYZus{}curve} \PY{p}{(}\PY{n}{trueValues} \PY{p}{,} \PY{n}{predictions}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{fpr}\PY{p}{,}\PY{n}{tpr}\PY{p}{)} 
\PY{n}{plt}\PY{o}{.}\PY{n}{axis}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)} 
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{False Positive Rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} 
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{True Positive Rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} 
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Done!}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras} \PY{k}{import} \PY{n}{applications}

\PY{c+c1}{\PYZsh{} This will load the whole VGG16 network, including the top Dense layers.}
\PY{c+c1}{\PYZsh{} Note: by specifying the shape of top layers, input tensor shape is forced}
\PY{c+c1}{\PYZsh{} to be (224, 224, 3), therefore you can use it only on 224x224 images.}
\PY{c+c1}{\PYZsh{}vgg\PYZus{}model = applications.VGG16(weights=\PYZsq{}imagenet\PYZsq{}, include\PYZus{}top=True)}

\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{VGG16!}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{c+c1}{\PYZsh{} If you are only interested in convolution filters. Note that by not}
\PY{c+c1}{\PYZsh{} specifying the shape of top layers, the input tensor shape is (None, None, 3),}
\PY{c+c1}{\PYZsh{} so you can use them for any size of images.}
\PY{c+c1}{\PYZsh{}vgg\PYZus{}model = applications.VGG16(weights=\PYZsq{}imagenet\PYZsq{}, include\PYZus{}top=False)}
\PY{n}{vgg\PYZus{}model} \PY{o}{=} \PY{n}{applications}\PY{o}{.}\PY{n}{VGG16}\PY{p}{(}\PY{n}{weights}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{imagenet}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{include\PYZus{}top}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{classes}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
\PY{c+c1}{\PYZsh{}print(\PYZdq{}VGG16!\PYZdq{})}
\PY{c+c1}{\PYZsh{} If you want to specify input tensor}
\PY{c+c1}{\PYZsh{}from keras.layers import Input}
\PY{c+c1}{\PYZsh{}input\PYZus{}tensor = Input(shape=(160, 160, 3))}
\PY{c+c1}{\PYZsh{}vgg\PYZus{}model = applications.VGG16(weights=\PYZsq{}imagenet\PYZsq{}, include\PYZus{}top=False, input\PYZus{}tensor=input\PYZus{}tensor)}

\PY{c+c1}{\PYZsh{} To see the models\PYZsq{} architecture and layer names, run the following}
\PY{c+c1}{\PYZsh{}vgg\PYZus{}model.summary()}

\PY{c+c1}{\PYZsh{}image = load\PYZus{}img()}

\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Done!}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{preprocessing}\PY{n+nn}{.}\PY{n+nn}{image} \PY{k}{import} \PY{n}{load\PYZus{}img}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{preprocessing}\PY{n+nn}{.}\PY{n+nn}{image} \PY{k}{import} \PY{n}{img\PYZus{}to\PYZus{}array}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{applications}\PY{n+nn}{.}\PY{n+nn}{vgg16} \PY{k}{import} \PY{n}{preprocess\PYZus{}input}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{applications}\PY{n+nn}{.}\PY{n+nn}{vgg16} \PY{k}{import} \PY{n}{decode\PYZus{}predictions}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{applications}\PY{n+nn}{.}\PY{n+nn}{vgg16} \PY{k}{import} \PY{n}{VGG16}

\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Import}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{vgg\PYZus{}model} \PY{o}{=} \PY{n}{VGG16}\PY{p}{(}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{VGG16}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{path} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{F:}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{Workspace}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{Datasets}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{Bus and Car}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{Training}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{electric bus}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{821c1f91.jpg}\PY{l+s+s2}{\PYZdq{}}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Image}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{img} \PY{o}{=} \PY{n}{load\PYZus{}img}\PY{p}{(}\PY{n}{path}\PY{p}{,} \PY{n}{target\PYZus{}size}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{224}\PY{p}{,} \PY{l+m+mi}{224}\PY{p}{)}\PY{p}{)}
\PY{n}{img} \PY{o}{=} \PY{n}{img\PYZus{}to\PYZus{}array}\PY{p}{(}\PY{n}{img}\PY{p}{)}
\PY{n}{img} \PY{o}{=} \PY{n}{img}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{img}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{img}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{img}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{)}\PY{p}{)}
\PY{n}{img} \PY{o}{=} \PY{n}{preprocess\PYZus{}input}\PY{p}{(}\PY{n}{img}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Prediction}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{values} \PY{o}{=} \PY{n}{vgg\PYZus{}model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{img}\PY{p}{)}
\PY{c+c1}{\PYZsh{}print(len(values[0]))}
\PY{n}{prediction} \PY{o}{=} \PY{n}{decode\PYZus{}predictions}\PY{p}{(}\PY{n}{values}\PY{p}{)}
\PY{n}{prediction} \PY{o}{=} \PY{n}{prediction}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}

\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s1}{ (}\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+si}{\PYZpc{}\PYZpc{}}\PY{l+s+s1}{)}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{prediction}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{prediction}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{*}\PY{l+m+mi}{100}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{3}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{os}
\PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{preprocessing}\PY{n+nn}{.}\PY{n+nn}{image} \PY{k}{import} \PY{n}{load\PYZus{}img}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{preprocessing}\PY{n+nn}{.}\PY{n+nn}{image} \PY{k}{import} \PY{n}{img\PYZus{}to\PYZus{}array}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{applications}\PY{n+nn}{.}\PY{n+nn}{vgg16} \PY{k}{import} \PY{n}{preprocess\PYZus{}input}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{applications}\PY{n+nn}{.}\PY{n+nn}{vgg16} \PY{k}{import} \PY{n}{decode\PYZus{}predictions}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{applications}\PY{n+nn}{.}\PY{n+nn}{vgg16} \PY{k}{import} \PY{n}{VGG16}

\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Imports}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{vgg\PYZus{}model} \PY{o}{=} \PY{n}{VGG16}\PY{p}{(}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{VGG16}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{path} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{F:/Workspace/Test/input/validation}\PY{l+s+s2}{\PYZdq{}}

\PY{n}{allValues} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{n}{trueValues} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{n}{cont} \PY{o}{=} \PY{l+m+mi}{0}

\PY{k}{for} \PY{n}{folders} \PY{o+ow}{in} \PY{n}{os}\PY{o}{.}\PY{n}{listdir}\PY{p}{(}\PY{n}{path}\PY{p}{)}\PY{p}{:}
    \PY{n}{folder} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{path}\PY{p}{,} \PY{n}{folders}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{n}{folder}\PY{p}{)}
    \PY{n}{folderValues} \PY{o}{=} \PY{p}{[}\PY{p}{]}
    
    \PY{k}{for} \PY{n}{filename} \PY{o+ow}{in} \PY{n}{os}\PY{o}{.}\PY{n}{listdir}\PY{p}{(}\PY{n}{folder}\PY{p}{)}\PY{p}{:}
        \PY{n}{trueValues}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{cont}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}end = len(filename)}
        \PY{c+c1}{\PYZsh{}ext = filename[\PYZhy{}4:end]}

        \PY{c+c1}{\PYZsh{}if ext != \PYZdq{}.png\PYZdq{}:}
        \PY{n}{file} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{folder}\PY{p}{,} \PY{n}{filename}\PY{p}{)}

        \PY{c+c1}{\PYZsh{}img = cv2.imread(file)}
            
        \PY{n}{img} \PY{o}{=} \PY{n}{load\PYZus{}img}\PY{p}{(}\PY{n}{file}\PY{p}{,} \PY{n}{target\PYZus{}size}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{224}\PY{p}{,} \PY{l+m+mi}{224}\PY{p}{)}\PY{p}{)}
        \PY{n}{img} \PY{o}{=} \PY{n}{img\PYZus{}to\PYZus{}array}\PY{p}{(}\PY{n}{img}\PY{p}{)}
        \PY{n}{img} \PY{o}{=} \PY{n}{img}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{img}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{img}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{img}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{)}\PY{p}{)}
        \PY{n}{img} \PY{o}{=} \PY{n}{preprocess\PYZus{}input}\PY{p}{(}\PY{n}{img}\PY{p}{)}

        \PY{n}{values} \PY{o}{=} \PY{n}{vgg\PYZus{}model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{img}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}print()}
        \PY{n}{prediction} \PY{o}{=} \PY{n}{decode\PYZus{}predictions}\PY{p}{(}\PY{n}{values}\PY{p}{)}
        \PY{n}{prediction} \PY{o}{=} \PY{n}{prediction}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
        \PY{n}{predic} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{argmax}\PY{p}{(}\PY{n}{values}\PY{p}{)}

        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s1}{: }\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s1}{ (}\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+si}{\PYZpc{}\PYZpc{}}\PY{l+s+s1}{)}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{filename}\PY{p}{,} \PY{n}{prediction}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{prediction}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{*}\PY{l+m+mi}{100}\PY{p}{)}\PY{p}{)}
        
    \PY{n}{cont} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
    \PY{n}{allValues}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{predic}\PY{p}{)}
    
\PY{c+c1}{\PYZsh{}print(allValues)}
\PY{c+c1}{\PYZsh{}print(trueValues)}
\PY{c+c1}{\PYZsh{}print(len(allValues), len(trueValues))}

\PY{c+c1}{\PYZsh{}from sklearn.metrics import roc\PYZus{}curve}
\PY{c+c1}{\PYZsh{}y\PYZus{}pred\PYZus{}keras = keras\PYZus{}model.predict(X\PYZus{}test).ravel()}
\PY{c+c1}{\PYZsh{}fpr\PYZus{}keras, tpr\PYZus{}keras, thresholds\PYZus{}keras = roc\PYZus{}curve(y\PYZus{}test, y\PYZus{}pred\PYZus{}keras)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Imports
VGG16
F:/Workspace/Test/input/validation\textbackslash{}electric bus
images-123.jpeg: streetcar (18.04\%)
images-125.jpeg: trolleybus (64.69\%)
images-126.jpeg: passenger\_car (75.02\%)
images-127.jpeg: trolleybus (81.84\%)
images-128.jpeg: streetcar (58.05\%)
images-129.jpeg: trolleybus (34.37\%)
images-130.jpeg: minibus (69.42\%)
images-131.jpeg: trolleybus (69.58\%)
images-132.jpeg: passenger\_car (48.84\%)
images-133.jpeg: minibus (97.71\%)
images-134.jpeg: minibus (44.66\%)
images-135.jpeg: crane (16.59\%)
images-136.jpeg: moving\_van (73.99\%)
images-137.jpeg: trolleybus (38.90\%)
images-138.jpeg: trolleybus (90.60\%)
images-139.jpeg: gas\_pump (17.02\%)
images-140.jpeg: Polaroid\_camera (13.28\%)
images-141.jpeg: trolleybus (87.30\%)
images-142.jpeg: trolleybus (95.26\%)
images-143.jpeg: trolleybus (68.29\%)
images-144.jpeg: trolleybus (90.79\%)
images-145.jpeg: passenger\_car (47.69\%)
images-146.jpeg: streetcar (25.22\%)
images-147.jpeg: trolleybus (95.42\%)
images-148.jpeg: trolleybus (99.70\%)
images-149.jpeg: passenger\_car (49.74\%)
images-150.jpeg: trolleybus (17.05\%)
images-151.jpeg: minibus (40.01\%)
images-152.jpeg: streetcar (78.74\%)
images-153.jpeg: streetcar (91.28\%)
images-154.jpeg: streetcar (41.34\%)
images-155.jpeg: trolleybus (75.99\%)
images-156.jpeg: trolleybus (94.14\%)
images-157.jpeg: moving\_van (76.51\%)
images-158.jpeg: minibus (88.25\%)
images-159.jpeg: streetcar (96.79\%)
images-160.jpeg: streetcar (64.19\%)
images-161.jpeg: trolleybus (35.18\%)
images-162.jpeg: trolleybus (61.27\%)
images-163.jpeg: streetcar (32.60\%)
images-164.jpeg: school\_bus (87.21\%)
images-165.jpeg: trolleybus (52.77\%)
images-166.jpeg: passenger\_car (77.72\%)
images-167.jpeg: trolleybus (43.39\%)
images-168.jpeg: school\_bus (94.42\%)
images-169.jpeg: gondola (18.73\%)
images-170.jpeg: streetcar (12.23\%)
images-171.jpeg: streetcar (32.25\%)
images-172.jpeg: streetcar (80.20\%)
images-173.jpeg: recreational\_vehicle (53.98\%)
images-174.jpeg: recreational\_vehicle (78.23\%)
images-175.jpeg: passenger\_car (74.78\%)
images-176.jpeg: trolleybus (73.62\%)
images-177.jpeg: streetcar (90.53\%)
images-178.jpeg: passenger\_car (42.63\%)
images-180.jpeg: streetcar (31.00\%)
images-181.jpeg: trolleybus (55.82\%)
images-182.jpeg: minibus (83.41\%)
images-183.jpeg: container\_ship (52.31\%)
images-184.jpeg: trolleybus (89.72\%)
images-185.jpeg: streetcar (92.81\%)
images-186.jpeg: garbage\_truck (52.07\%)
images-187.jpeg: streetcar (48.36\%)
images-188.jpeg: trolleybus (65.49\%)
images-189.jpeg: trolleybus (53.52\%)
images-190.jpeg: trolleybus (16.44\%)
images-191.jpeg: recreational\_vehicle (47.65\%)
images-193.jpeg: passenger\_car (29.45\%)
images-195.jpeg: recreational\_vehicle (87.74\%)
images-196.jpeg: trolleybus (62.43\%)
images-197.jpeg: street\_sign (18.71\%)
images-198.jpeg: streetcar (73.53\%)
images-199.jpeg: trolleybus (55.67\%)
images-200.jpeg: minibus (83.82\%)
images-201.jpeg: trolleybus (80.92\%)
images-202.jpeg: trolleybus (83.68\%)
images-203.jpeg: streetcar (58.34\%)
images-204.jpeg: trolleybus (49.59\%)
images-205.jpeg: trolleybus (36.57\%)
images-206.jpeg: trolleybus (59.04\%)
images-207.jpeg: trolleybus (96.54\%)
images-208.jpeg: trolleybus (29.58\%)
images-209.jpeg: trolleybus (77.50\%)
images-210.jpeg: passenger\_car (36.92\%)
images-211.jpeg: minibus (33.34\%)
images-212.jpeg: passenger\_car (27.14\%)
images-214.jpeg: dumbbell (51.00\%)
images-216.jpeg: trolleybus (30.89\%)
images-217.jpeg: minibus (58.46\%)
images-218.jpeg: solar\_dish (34.92\%)
images-219.jpeg: minibus (25.16\%)
images-220.jpeg: racer (59.01\%)
images-221.jpeg: trolleybus (97.19\%)
images-222.jpeg: streetcar (48.05\%)
images-223.jpeg: streetcar (35.58\%)
images-224.jpeg: trolleybus (94.67\%)
images-225.jpeg: trolleybus (63.70\%)
images-226.jpeg: recreational\_vehicle (43.86\%)
images-227.jpeg: streetcar (64.35\%)
images-228.jpeg: trolleybus (94.97\%)
images-229.jpeg: trolleybus (80.79\%)
images-230.jpeg: moving\_van (37.28\%)
images-231.jpeg: trolleybus (46.36\%)
images-232.jpeg: passenger\_car (42.69\%)
images-233.jpeg: trolleybus (88.38\%)
images-234.jpeg: streetcar (52.56\%)
images-235.jpeg: trolleybus (95.38\%)
images-236.jpeg: trailer\_truck (39.86\%)
images-237.jpeg: trolleybus (39.98\%)
images-238.jpeg: garbage\_truck (35.92\%)
images-239.jpeg: trolleybus (73.62\%)
images-240.jpeg: minibus (94.01\%)
images-241.jpeg: trolleybus (42.25\%)
images-242.jpeg: minibus (35.05\%)
images-245.jpeg: trolleybus (82.47\%)
images-246.jpeg: trolleybus (75.64\%)
images-247.jpeg: streetcar (46.39\%)
images-248.jpeg: streetcar (84.31\%)
images-249.jpeg: minibus (57.67\%)
images-250.jpeg: trolleybus (98.70\%)
images-251.jpeg: passenger\_car (42.33\%)
images-253.jpeg: streetcar (9.07\%)
images-254.jpeg: streetcar (20.99\%)
images-255.jpeg: streetcar (84.58\%)
images-256.jpeg: trolleybus (71.48\%)
images-257.jpeg: passenger\_car (35.99\%)
images-258.jpeg: dam (23.92\%)
images-259.jpeg: forklift (15.60\%)
images-260.jpeg: streetcar (94.07\%)
images-261.jpeg: trolleybus (80.07\%)
images-262.jpeg: streetcar (60.82\%)
images-264.jpeg: fire\_engine (60.85\%)
images-265.jpeg: passenger\_car (12.83\%)
images-266.jpeg: trolleybus (62.80\%)
images-267.jpeg: trolleybus (48.62\%)
images-268.jpeg: trolleybus (55.20\%)
images-269.jpeg: trolleybus (69.22\%)
images-272.jpeg: recreational\_vehicle (36.38\%)
images-273.jpeg: golfcart (78.05\%)
images-275.jpeg: streetcar (57.10\%)
images-276.jpeg: streetcar (59.04\%)
images-277.jpeg: streetcar (86.95\%)
images-278.jpeg: turnstile (99.26\%)
images-279.jpeg: streetcar (54.83\%)
images-280.jpeg: streetcar (69.74\%)
images-281.jpeg: passenger\_car (42.68\%)
images-282.jpeg: streetcar (83.99\%)
images-283.jpeg: trolleybus (95.12\%)
images-284.jpeg: passenger\_car (53.09\%)
images-285.jpeg: streetcar (47.89\%)
images-287.jpeg: streetcar (53.04\%)
images-288.jpeg: streetcar (85.39\%)
images-289.jpeg: police\_van (17.48\%)
images-290.jpeg: streetcar (54.12\%)
images-291.jpeg: vestment (23.12\%)
images-293.jpeg: vending\_machine (7.27\%)
images-294.jpeg: passenger\_car (32.18\%)
images-295.jpeg: trolleybus (94.67\%)
images-296.jpeg: trolleybus (93.43\%)
images-297.jpeg: trolleybus (97.91\%)
images-298.jpeg: harvester (29.33\%)
images-300.jpeg: minibus (78.98\%)
images-301.jpeg: trolleybus (81.79\%)
images-302.jpeg: trolleybus (47.29\%)
images-304.jpeg: minibus (64.51\%)
images-306.jpeg: trolleybus (36.17\%)
images-307.jpeg: minibus (46.74\%)
images-308.jpeg: recreational\_vehicle (55.08\%)
images-310.jpeg: passenger\_car (32.84\%)
images-311.jpeg: streetcar (25.98\%)
images-312.jpeg: minibus (46.74\%)
images-313.jpeg: streetcar (15.98\%)
images-314.jpeg: streetcar (49.30\%)
images-315.jpeg: trolleybus (47.67\%)
images-316.jpeg: minibus (56.23\%)
images-317.jpeg: streetcar (35.66\%)
images-318.jpeg: fire\_engine (39.34\%)
images-319.jpeg: streetcar (90.14\%)
images-320.jpeg: garbage\_truck (24.14\%)
images-321.jpeg: recreational\_vehicle (45.50\%)
images-323.jpeg: car\_mirror (17.02\%)
images-324.jpeg: trolleybus (93.41\%)
images-325.jpeg: trolleybus (94.39\%)
images-326.jpeg: trolleybus (77.83\%)
images-327.jpeg: minibus (87.16\%)
images-329.jpeg: trolleybus (90.73\%)
images-330.jpeg: trolleybus (54.65\%)
images-332.jpeg: passenger\_car (33.92\%)
images-333.jpeg: trolleybus (40.92\%)
images-334.jpeg: streetcar (76.07\%)
images-335.jpeg: streetcar (46.38\%)
F:/Workspace/Test/input/validation\textbackslash{}electric car
electric\_car-12.jpeg: sports\_car (44.69\%)
electric\_car-13.jpeg: minivan (55.91\%)
electric\_car-14.jpeg: sports\_car (74.38\%)
electric\_car-16.jpeg: sports\_car (78.27\%)
electric\_car-17.jpeg: sports\_car (43.93\%)
electric\_car-18.jpeg: minivan (47.13\%)
electric\_car-19.jpeg: limousine (31.94\%)
electric\_car-20.jpeg: sports\_car (19.00\%)
electric\_car-21.jpeg: cab (9.44\%)
electric\_car-24.jpeg: sports\_car (66.55\%)
electric\_car-25.jpeg: minivan (74.07\%)
electric\_\_image-100.jpeg: racer (49.51\%)
electric\_\_image-101.jpeg: sports\_car (31.62\%)
electric\_\_image-102.jpeg: sports\_car (43.48\%)
electric\_\_image-103.jpeg: sports\_car (72.43\%)
electric\_\_image-104.jpeg: racer (16.32\%)
electric\_\_image-105.jpeg: sports\_car (67.30\%)
electric\_\_image-106.jpeg: sports\_car (50.42\%)
electric\_\_image-107.jpeg: minibus (20.52\%)
electric\_\_image-108.jpeg: sports\_car (61.63\%)
electric\_\_image-109.jpeg: minivan (47.64\%)
electric\_\_image-111.jpeg: minivan (33.01\%)
electric\_\_image-112.jpeg: minivan (25.32\%)
electric\_\_image-113.jpeg: sports\_car (25.69\%)
electric\_\_image-114.jpeg: sports\_car (94.45\%)
electric\_\_image-115.jpeg: minivan (24.03\%)
electric\_\_image-118.jpeg: sports\_car (58.41\%)
electric\_\_image-12.jpeg: minivan (25.10\%)
electric\_\_image-120.jpeg: minivan (17.83\%)
electric\_\_image-121.jpeg: limousine (38.49\%)
electric\_\_image-122.jpeg: pickup (29.85\%)
electric\_\_image-123.jpeg: sports\_car (68.01\%)
electric\_\_image-124.jpeg: sports\_car (54.35\%)
electric\_\_image-127.jpeg: sports\_car (91.18\%)
electric\_\_image-128.jpeg: convertible (81.78\%)
electric\_\_image-129.jpeg: sports\_car (47.60\%)
electric\_\_image-130.jpeg: car\_wheel (30.58\%)
electric\_\_image-131.jpeg: racer (16.76\%)
electric\_\_image-134.jpeg: sports\_car (59.96\%)
electric\_\_image-135.jpeg: convertible (22.69\%)
electric\_\_image-14.jpeg: sports\_car (57.99\%)
electric\_\_image-16.jpeg: racer (47.62\%)
electric\_\_image-17.jpeg: minivan (35.92\%)
electric\_\_image-19.jpeg: sports\_car (47.56\%)
electric\_\_image-2.jpeg: sports\_car (67.90\%)
electric\_\_image-20.jpeg: sports\_car (50.17\%)
electric\_\_image-21.jpeg: beach\_wagon (64.34\%)
electric\_\_image-22.jpeg: car\_mirror (26.32\%)
electric\_\_image-23.jpeg: minivan (95.20\%)
electric\_\_image-24.jpeg: sports\_car (23.66\%)
electric\_\_image-27.jpeg: minivan (50.02\%)
electric\_\_image-28.jpeg: sports\_car (62.35\%)
electric\_\_image-29.jpeg: grille (19.63\%)
electric\_\_image-3.jpeg: sports\_car (75.26\%)
electric\_\_image-30.jpeg: sports\_car (50.31\%)
electric\_\_image-31.jpeg: sports\_car (64.15\%)
electric\_\_image-32.jpeg: sports\_car (42.23\%)
electric\_\_image-33.jpeg: sports\_car (34.98\%)
electric\_\_image-34.jpeg: sports\_car (39.42\%)
electric\_\_image-35.jpeg: minivan (53.42\%)
electric\_\_image-38.jpeg: sports\_car (61.05\%)
electric\_\_image-39.jpeg: sports\_car (31.76\%)
electric\_\_image-4.jpeg: sports\_car (72.49\%)
electric\_\_image-40.jpeg: sports\_car (63.33\%)
electric\_\_image-42.jpeg: sports\_car (71.22\%)
electric\_\_image-43.jpeg: minivan (42.72\%)
electric\_\_image-45.jpeg: sports\_car (78.04\%)
electric\_\_image-49.jpeg: sports\_car (54.54\%)
electric\_\_image-5.jpeg: sports\_car (31.96\%)
electric\_\_image-50.jpeg: sports\_car (72.77\%)
electric\_\_image-51.jpeg: sports\_car (49.73\%)
electric\_\_image-53.jpeg: sports\_car (79.26\%)
electric\_\_image-54.jpeg: beach\_wagon (22.02\%)
electric\_\_image-56.jpeg: minivan (48.20\%)
electric\_\_image-58.jpeg: sports\_car (56.53\%)
electric\_\_image-59.jpeg: golfcart (25.35\%)
electric\_\_image-6.jpeg: sports\_car (65.35\%)
electric\_\_image-60.jpeg: sports\_car (40.02\%)
electric\_\_image-61.jpeg: racer (52.96\%)
electric\_\_image-63.jpeg: sports\_car (87.90\%)
electric\_\_image-64.jpeg: sports\_car (40.36\%)
electric\_\_image-65.jpeg: sports\_car (25.67\%)
electric\_\_image-68.jpeg: sports\_car (50.28\%)
electric\_\_image-71.jpeg: sports\_car (55.43\%)
electric\_\_image-73.jpeg: sports\_car (76.26\%)
electric\_\_image-75.jpeg: racer (50.67\%)
electric\_\_image-76.jpeg: racer (52.87\%)
electric\_\_image-78.jpeg: sports\_car (57.19\%)
electric\_\_image-79.jpeg: minivan (35.77\%)
electric\_\_image-80.jpeg: sports\_car (67.79\%)
electric\_\_image-81.jpeg: minivan (65.04\%)
electric\_\_image-86.jpeg: sports\_car (46.68\%)
electric\_\_image-87.jpeg: sports\_car (37.19\%)
electric\_\_image-88.jpeg: parking\_meter (30.10\%)
electric\_\_image-89.jpeg: beach\_wagon (35.65\%)
electric\_\_image-90.jpeg: racer (32.08\%)
electric\_\_image-92.jpeg: sports\_car (48.56\%)
electric\_\_image-94.jpeg: sports\_car (42.10\%)
electric\_\_image-95.jpeg: minivan (54.86\%)
electric\_\_image-97.jpeg: minivan (37.73\%)
electric\_\_image-98.jpeg: convertible (37.01\%)
electric\_\_image-99.jpeg: sports\_car (41.10\%)
electric\_\_image.jpeg: sports\_car (80.31\%)
image-641.jpeg: minivan (32.38\%)
image-642.jpeg: minibus (37.59\%)
image-643.jpeg: minivan (12.82\%)
image-644.jpeg: sports\_car (41.66\%)
image-645.jpeg: sports\_car (84.88\%)
image-646.jpeg: racer (50.12\%)
image-647.jpeg: lens\_cap (32.01\%)
image-648.jpeg: pickup (41.62\%)
image-650.jpeg: beach\_wagon (29.69\%)
image-651.jpeg: sports\_car (59.03\%)
image-653.jpeg: sports\_car (34.19\%)
image-655.jpeg: sports\_car (60.77\%)
image-658.jpeg: sports\_car (32.16\%)
image-660.jpeg: sports\_car (35.21\%)
image-661.jpeg: sports\_car (46.55\%)
image-662.jpeg: sports\_car (55.07\%)
image-664.jpeg: sports\_car (27.85\%)
image-665.jpeg: sports\_car (56.75\%)
image-667.jpeg: sports\_car (54.72\%)
image-668.jpeg: sports\_car (41.75\%)
image-672.jpeg: beach\_wagon (54.06\%)
image-674.jpeg: sports\_car (39.31\%)
image-675.jpeg: beach\_wagon (32.26\%)
image-676.jpeg: jeep (37.17\%)
image-683.jpeg: convertible (14.01\%)
image-684.jpeg: sports\_car (55.91\%)
image-685.jpeg: sports\_car (56.58\%)
image-686.jpeg: sports\_car (45.57\%)
image-687.jpeg: beach\_wagon (40.14\%)
image-688.jpeg: racer (65.30\%)
image-689.jpeg: sports\_car (55.97\%)
image-690.jpeg: racer (52.27\%)
image-691.jpeg: racer (74.29\%)
image-692.jpeg: cash\_machine (17.30\%)
image-694.jpeg: sports\_car (29.20\%)
image-695.jpeg: sports\_car (72.49\%)
image-696.jpeg: sports\_car (72.60\%)
image-698.jpeg: sports\_car (26.41\%)
image-699.jpeg: sports\_car (28.95\%)
image-701.jpeg: golfcart (46.34\%)
image-702.jpeg: golfcart (99.99\%)
image-703.jpeg: sports\_car (56.54\%)
image-704.jpeg: minivan (26.45\%)
image-705.jpeg: sports\_car (80.11\%)
image-706.jpeg: sports\_car (83.49\%)
image-709.jpeg: limousine (62.60\%)
image-710.jpeg: sports\_car (61.17\%)
image-711.jpeg: convertible (56.31\%)
image-712.jpeg: convertible (25.16\%)
image-714.jpeg: racer (49.08\%)
image-715.jpeg: sports\_car (84.53\%)
image-716.jpeg: sports\_car (59.37\%)
image-717.jpeg: sports\_car (85.66\%)
image-718.jpeg: sports\_car (46.46\%)
image-719.jpeg: sports\_car (45.62\%)
image-720.jpeg: sports\_car (91.72\%)
image-721.jpeg: sports\_car (64.85\%)
image-722.jpeg: minivan (52.62\%)
image-726.jpeg: minivan (23.80\%)
image-728.jpeg: golfcart (66.48\%)
image-730.jpeg: minivan (31.87\%)
image-733.jpeg: minivan (15.95\%)
image-738.jpeg: sports\_car (61.72\%)
image-739.jpeg: sports\_car (46.46\%)
image-744.jpeg: sports\_car (22.46\%)
image-748.jpeg: tow\_truck (10.38\%)
image-752.jpeg: sports\_car (55.40\%)
image-754.jpeg: sports\_car (37.36\%)
image-755.jpeg: grille (16.86\%)
image-758.jpeg: beach\_wagon (43.92\%)
image-759.jpeg: sports\_car (46.77\%)
image-761.jpeg: minivan (87.03\%)
image-764.jpeg: sports\_car (39.51\%)
image-765.jpeg: sports\_car (68.99\%)
image-769.jpeg: sports\_car (41.76\%)
image-775.jpeg: jeep (65.31\%)
image-777.jpeg: sports\_car (56.91\%)
image-779.jpeg: ashcan (13.67\%)
image-780.jpeg: minivan (15.67\%)
image-781.jpeg: street\_sign (34.12\%)
image-782.jpeg: snowplow (23.08\%)
image-783.jpeg: sports\_car (69.18\%)
image-784.jpeg: ambulance (16.18\%)
image-790.jpeg: beach\_wagon (18.23\%)
image-792.jpeg: sports\_car (44.67\%)
image-793.jpeg: convertible (46.22\%)
image-795.jpeg: obelisk (16.16\%)
image-801.jpeg: cab (22.59\%)
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{}MAPEAMENTO}
\PY{k+kn}{import} \PY{n+nn}{tensorflow} \PY{k}{as} \PY{n+nn}{tf}

\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{models} \PY{k}{import} \PY{n}{Sequential}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers} \PY{k}{import} \PY{n}{Convolution2D}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers} \PY{k}{import} \PY{n}{MaxPooling2D}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers} \PY{k}{import} \PY{n}{Flatten}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers} \PY{k}{import} \PY{n}{Dense}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers} \PY{k}{import} \PY{n}{BatchNormalization}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers} \PY{k}{import} \PY{n}{Dropout}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras} \PY{k}{import} \PY{n}{applications}

\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers} \PY{k}{import} \PY{n}{Input}\PY{p}{,} \PY{n}{Flatten}\PY{p}{,} \PY{n}{Dense}
\PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{models} \PY{k}{import} \PY{n}{Model}

\PY{k+kn}{from} \PY{n+nn}{datetime} \PY{k}{import} \PY{n}{datetime}

\PY{k+kn}{import} \PY{n+nn}{os}

\PY{n}{batchSize} \PY{o}{=} \PY{l+m+mi}{1}

\PY{n}{classifier}\PY{o}{=}\PY{n}{tf}\PY{o}{.}\PY{n}{keras}\PY{o}{.}\PY{n}{Sequential}\PY{p}{(}\PY{p}{)}   \PY{c+c1}{\PYZsh{} Intialializing CNN}

\PY{n}{shape} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{224}\PY{p}{,} \PY{l+m+mi}{224}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{)}
\PY{n}{vggModel}\PY{o}{=}\PY{n}{tf}\PY{o}{.}\PY{n}{keras}\PY{o}{.}\PY{n}{applications}\PY{o}{.}\PY{n}{VGG16}\PY{p}{(}\PY{n}{input\PYZus{}shape}\PY{o}{=}\PY{n}{shape}\PY{p}{,}
                                               \PY{n}{include\PYZus{}top}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}
                                               \PY{n}{weights}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{imagenet}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{vggModel}\PY{o}{.}\PY{n}{trainable} \PY{o}{=} \PY{k+kc}{False}
\PY{n}{classifier}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{vggModel}\PY{p}{)}

\PY{c+c1}{\PYZsh{}classifier.add(Flatten()) }
\PY{n}{classifier}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dense}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{activation} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sigmoid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}

\PY{n}{classifier}\PY{o}{.}\PY{n}{compile}\PY{p}{(}\PY{n}{optimizer} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{adam}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{loss} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{binary\PYZus{}crossentropy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{metrics} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{accuracy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{classifier}\PY{o}{.}\PY{n}{summary}\PY{p}{(}\PY{p}{)}

\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{preprocessing}\PY{n+nn}{.}\PY{n+nn}{image} \PY{k}{import} \PY{n}{ImageDataGenerator}

\PY{n}{path}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{input/training\PYZus{}set}\PY{l+s+s2}{\PYZdq{}}

\PY{n}{train\PYZus{}datagen} \PY{o}{=} \PY{n}{ImageDataGenerator}\PY{p}{(}\PY{n}{rescale}\PY{o}{=}\PY{l+m+mf}{1.}\PY{o}{/}\PY{l+m+mi}{255}\PY{p}{)}

\PY{n}{test\PYZus{}datagen} \PY{o}{=} \PY{n}{ImageDataGenerator}\PY{p}{(}\PY{n}{rescale}\PY{o}{=}\PY{l+m+mf}{1.}\PY{o}{/}\PY{l+m+mi}{255}\PY{p}{)}

\PY{n}{training\PYZus{}set} \PY{o}{=} \PY{n}{train\PYZus{}datagen}\PY{o}{.}\PY{n}{flow\PYZus{}from\PYZus{}directory}\PY{p}{(} \PY{n}{path}\PY{p}{,}
                                                    \PY{n}{target\PYZus{}size}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{224}\PY{p}{,} \PY{l+m+mi}{224}\PY{p}{)}\PY{p}{,}
                                                    \PY{n}{batch\PYZus{}size}\PY{o}{=}\PY{n}{batchSize}\PY{p}{,}
                                                    \PY{n}{class\PYZus{}mode}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{binary}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{path}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{input/validation}\PY{l+s+s2}{\PYZdq{}}

\PY{n}{validSet} \PY{o}{=} \PY{n}{test\PYZus{}datagen}\PY{o}{.}\PY{n}{flow\PYZus{}from\PYZus{}directory}\PY{p}{(}
                                              \PY{n}{path}\PY{p}{,}
                                              \PY{n}{target\PYZus{}size}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{224}\PY{p}{,}\PY{l+m+mi}{224}\PY{p}{)}\PY{p}{,}
                                              \PY{n}{batch\PYZus{}size}\PY{o}{=}\PY{n}{batchSize}\PY{p}{,}
                                              \PY{n}{class\PYZus{}mode}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{binary}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{epochs} \PY{o}{=} \PY{l+m+mi}{10}
\PY{n}{steps} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{training\PYZus{}set}\PY{p}{)}\PY{o}{/}\PY{n}{batchSize}
\PY{n}{checkpoint\PYZus{}path} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{checkpoints/cp2.ckpt}\PY{l+s+s2}{\PYZdq{}}
\PY{n}{checkpoint\PYZus{}dir} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{dirname}\PY{p}{(}\PY{n}{checkpoint\PYZus{}path}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Create a callback that saves the model\PYZsq{}s weights}
\PY{n}{cp} \PY{o}{=} \PY{n}{tf}\PY{o}{.}\PY{n}{keras}\PY{o}{.}\PY{n}{callbacks}\PY{o}{.}\PY{n}{ModelCheckpoint}\PY{p}{(}\PY{n}{filepath}\PY{o}{=}\PY{n}{checkpoint\PYZus{}path}\PY{p}{,}
                                                 \PY{n}{save\PYZus{}weights\PYZus{}only}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}
                                                 \PY{n}{verbose}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}

\PY{n}{validSteps} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{validSet}\PY{p}{)}\PY{o}{/}\PY{n}{batchSize}

\PY{n}{loss}\PY{p}{,} \PY{n}{acc} \PY{o}{=} \PY{n}{classifier}\PY{o}{.}\PY{n}{evaluate\PYZus{}generator}\PY{p}{(}\PY{n}{generator}\PY{o}{=}\PY{n}{validSet}\PY{p}{,}\PY{n}{steps}\PY{o}{=}\PY{n}{validSteps}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Untrained model, accuracy: }\PY{l+s+si}{\PYZob{}:5.2f\PYZcb{}}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{l+m+mi}{100}\PY{o}{*}\PY{n}{acc}\PY{p}{)}\PY{p}{)}

\PY{n}{history} \PY{o}{=} \PY{n}{classifier}\PY{o}{.}\PY{n}{fit\PYZus{}generator}\PY{p}{(}
    \PY{n}{training\PYZus{}set}\PY{p}{,}
    \PY{n}{steps\PYZus{}per\PYZus{}epoch}\PY{o}{=}\PY{n}{steps}\PY{p}{,}
    \PY{n}{epochs}\PY{o}{=}\PY{n}{epochs}\PY{p}{,}
    \PY{n}{validation\PYZus{}data}\PY{o}{=}\PY{n}{validSet}\PY{p}{,}
    \PY{n}{validation\PYZus{}steps}\PY{o}{=}\PY{n}{validSteps}\PY{p}{,} 
    \PY{n}{callbacks} \PY{o}{=} \PY{p}{[}\PY{n}{cp}\PY{p}{]}\PY{p}{)}
    
\PY{n}{savePath} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{checkpoints/newDenseModelTeste.h5}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{classifier}\PY{o}{.}\PY{n}{save}\PY{p}{(}\PY{n}{savePath}\PY{p}{)} 
    
\PY{n}{acc} \PY{o}{=} \PY{n}{history}\PY{o}{.}\PY{n}{history}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{acc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{val\PYZus{}acc} \PY{o}{=} \PY{n}{history}\PY{o}{.}\PY{n}{history}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{val\PYZus{}acc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{loss} \PY{o}{=} \PY{n}{history}\PY{o}{.}\PY{n}{history}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{loss}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{val\PYZus{}loss} \PY{o}{=} \PY{n}{history}\PY{o}{.}\PY{n}{history}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{val\PYZus{}loss}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}

\PY{n}{accStr} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{n}{val\PYZus{}accStr} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{n}{lossStr} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{n}{val\PYZus{}lossStr} \PY{o}{=} \PY{p}{[}\PY{p}{]}

\PY{n}{accStr} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ }\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n+nb}{str}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZob{}0:.2f\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{i}\PY{p}{)}\PY{p}{)} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{acc}\PY{p}{)}
\PY{n}{val\PYZus{}accStr} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ }\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n+nb}{str}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZob{}0:.2f\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{i}\PY{p}{)}\PY{p}{)} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{val\PYZus{}acc}\PY{p}{)}
\PY{n}{lossStr} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ }\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n+nb}{str}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZob{}0:.2f\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{i}\PY{p}{)}\PY{p}{)} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{loss}\PY{p}{)}
\PY{n}{val\PYZus{}lossStr} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ }\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n+nb}{str}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZob{}0:.2f\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{i}\PY{p}{)}\PY{p}{)} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{val\PYZus{}loss}\PY{p}{)}

\PY{k}{with} \PY{n+nb}{open}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{results/history.txt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{w}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{k}{as} \PY{n}{hist}\PY{p}{:}
    \PY{n}{hist}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{n}{accStr}\PY{o}{+}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{hist}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{n}{val\PYZus{}accStr}\PY{o}{+}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{hist}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{n}{lossStr}\PY{o}{+}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{hist}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{n}{val\PYZus{}lossStr}\PY{p}{)}

\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{roc\PYZus{}curve}\PY{p}{,}\PY{n}{roc\PYZus{}auc\PYZus{}score}

\PY{c+c1}{\PYZsh{} path = \PYZdq{}input/test\PYZdq{}}
\PY{c+c1}{\PYZsh{} test\PYZus{}generator = test\PYZus{}datagen.flow\PYZus{}from\PYZus{}directory(}
\PY{c+c1}{\PYZsh{}                                               path,}
\PY{c+c1}{\PYZsh{}                                               target\PYZus{}size=(244,244),}
\PY{c+c1}{\PYZsh{}                                               batch\PYZus{}size=batchSize,}
\PY{c+c1}{\PYZsh{}                                               class\PYZus{}mode=\PYZsq{}binary\PYZsq{})}

\PY{n}{trueValues} \PY{o}{=} \PY{n}{validSet}\PY{o}{.}\PY{n}{classes}
\PY{n}{predSteps} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{validSet}\PY{o}{.}\PY{n}{classes}\PY{p}{)} \PY{o}{/} \PY{n}{batchSize}
\PY{n}{predictions} \PY{o}{=} \PY{n}{classifier}\PY{o}{.}\PY{n}{predict\PYZus{}generator}\PY{p}{(}\PY{n}{validSet}\PY{p}{,}\PY{n}{steps} \PY{o}{=} \PY{n}{predSteps}\PY{p}{,}\PY{n}{verbose}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}




\PY{n}{fpr}\PY{p}{,} \PY{n}{tpr}\PY{p}{,} \PY{n}{thresholds} \PY{o}{=} \PY{n}{roc\PYZus{}curve} \PY{p}{(}\PY{n}{trueValues} \PY{p}{,} \PY{n}{predictions}\PY{p}{)}

\PY{n}{fprStr} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{n}{tprStr} \PY{o}{=} \PY{p}{[}\PY{p}{]}

\PY{n}{fprStr} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ }\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n+nb}{str}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZob{}0:.2f\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{i}\PY{p}{)}\PY{p}{)} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{fpr}\PY{p}{)}
\PY{n}{tprStr} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ }\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n+nb}{str}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZob{}0:.2f\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{i}\PY{p}{)}\PY{p}{)} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{tpr}\PY{p}{)}

\PY{k}{with} \PY{n+nb}{open}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{results/roc.txt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{w}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{k}{as} \PY{n}{curve}\PY{p}{:}
    \PY{n}{curve}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{n}{fprStr}\PY{o}{+}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{curve}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{n}{tprStr}\PY{p}{)}
    
\PY{n}{truesStr} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{n}{predicStr} \PY{o}{=} \PY{p}{[}\PY{p}{]}

\PY{n}{truesStr} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ }\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n+nb}{str}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZob{}0:.2f\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{i}\PY{p}{)}\PY{p}{)} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{trueValues} \PY{p}{)}
\PY{n}{predicStr} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ }\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n+nb}{str}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZob{}0:.2f\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{)} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{predictions}\PY{p}{)}

\PY{k}{with} \PY{n+nb}{open}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{results/predictions.txt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{w+}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{k}{as} \PY{n}{curve}\PY{p}{:}
    \PY{n}{curve}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{n}{truesStr} \PY{o}{+}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{curve}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{n}{predicStr}\PY{p}{)}

\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Done!}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{os}
\PY{k+kn}{import} \PY{n+nn}{cv2}
\PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
\PY{k+kn}{import} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{as} \PY{n+nn}{sklm}

\PY{c+c1}{\PYZsh{}from keras import optimizers}
\PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers} \PY{k}{import} \PY{n}{Input}\PY{p}{,} \PY{n}{Flatten}\PY{p}{,} \PY{n}{Dense}
\PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{models} \PY{k}{import} \PY{n}{Model}
\PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k}{import} \PY{n}{image}
\PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{preprocessing}\PY{n+nn}{.}\PY{n+nn}{image} \PY{k}{import} \PY{n}{ImageDataGenerator}
\PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{preprocessing}\PY{n+nn}{.}\PY{n+nn}{image} \PY{k}{import} \PY{n}{load\PYZus{}img}
\PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{preprocessing}\PY{n+nn}{.}\PY{n+nn}{image} \PY{k}{import} \PY{n}{img\PYZus{}to\PYZus{}array}
\PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{applications}\PY{n+nn}{.}\PY{n+nn}{vgg16} \PY{k}{import} \PY{n}{preprocess\PYZus{}input}
\PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{applications}\PY{n+nn}{.}\PY{n+nn}{vgg16} \PY{k}{import} \PY{n}{decode\PYZus{}predictions}
\PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{applications}\PY{n+nn}{.}\PY{n+nn}{vgg16} \PY{k}{import} \PY{n}{VGG16}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{train\PYZus{}test\PYZus{}split}

\PY{n}{batchSize} \PY{o}{=} \PY{l+m+mi}{16}
\PY{c+c1}{\PYZsh{} def createDataset(path):}
\PY{c+c1}{\PYZsh{}     imageSet = []}
\PY{c+c1}{\PYZsh{}     labels = []}
\PY{c+c1}{\PYZsh{}     classes = 0}
\PY{c+c1}{\PYZsh{}     for folders in os.listdir(path):}
\PY{c+c1}{\PYZsh{}         folder = os.path.join(path, folders)}
\PY{c+c1}{\PYZsh{}         print(folder)}
\PY{c+c1}{\PYZsh{}         classes = 1}
\PY{c+c1}{\PYZsh{}         for filename in os.listdir(folder):}
\PY{c+c1}{\PYZsh{}             file = os.path.join(folder, filename)}
            
\PY{c+c1}{\PYZsh{}             img = load\PYZus{}img(file, target\PYZus{}size=(224, 224))}
\PY{c+c1}{\PYZsh{}             img = img\PYZus{}to\PYZus{}array(img)}
\PY{c+c1}{\PYZsh{}             img = img.reshape((1, img.shape[0], img.shape[1], img.shape[2]))}
\PY{c+c1}{\PYZsh{}             imageSet.append(img)}
            
\PY{c+c1}{\PYZsh{}             labels.append(classes)}
            
\PY{c+c1}{\PYZsh{}     return imageSet, labels}

\PY{k}{def} \PY{n+nf}{generateTraining}\PY{p}{(}\PY{n}{path}\PY{p}{)}\PY{p}{:}
    \PY{n}{gen} \PY{o}{=} \PY{n}{ImageDataGenerator}\PY{p}{(}\PY{n}{rescale}\PY{o}{=}\PY{l+m+mi}{1}\PY{o}{/}\PY{l+m+mi}{255}\PY{p}{)}
    \PY{n}{generator} \PY{o}{=} \PY{n}{gen}\PY{o}{.}\PY{n}{flow\PYZus{}from\PYZus{}directory}\PY{p}{(}\PY{n}{path}\PY{p}{,}
                                       \PY{n}{target\PYZus{}size}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{224}\PY{p}{,}\PY{l+m+mi}{224}\PY{p}{)}\PY{p}{,}
                                       \PY{n}{batch\PYZus{}size}\PY{o}{=}\PY{n}{batchSize}\PY{p}{,}
                                       \PY{n}{classes} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bus}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{car}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                       \PY{n}{class\PYZus{}mode}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{binary}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{k}{return} \PY{n}{generator}

\PY{c+c1}{\PYZsh{}def loadModel(classes, layerType):}
        
\PY{k}{def} \PY{n+nf}{loadModel}\PY{p}{(}\PY{n}{classes}\PY{p}{,} \PY{n}{layerType}\PY{p}{)}\PY{p}{:}
    \PY{n}{vgg\PYZus{}model} \PY{o}{=} \PY{n}{VGG16}\PY{p}{(}\PY{n}{weights}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{imagenet}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{include\PYZus{}top}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}

    \PY{n}{inputShape} \PY{o}{=} \PY{n}{Input}\PY{p}{(}\PY{n}{shape}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{224}\PY{p}{,} \PY{l+m+mi}{224}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{)}\PY{p}{,} \PY{n}{name} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{image\PYZus{}input}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} 
    \PY{n}{outputNet} \PY{o}{=} \PY{n}{vgg\PYZus{}model}\PY{p}{(}\PY{n}{inputShape}\PY{p}{)}

    \PY{c+c1}{\PYZsh{}Add the fully\PYZhy{}connected layers }
    \PY{n}{outLayers} \PY{o}{=} \PY{n}{Flatten}\PY{p}{(}\PY{n}{name}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{flatten}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{(}\PY{n}{outputNet}\PY{p}{)}
    \PY{n}{outLayers} \PY{o}{=} \PY{n}{Dense}\PY{p}{(}\PY{l+m+mi}{4096}\PY{p}{,} \PY{n}{activation}\PY{o}{=}\PY{n}{layerType}\PY{p}{,} \PY{n}{name}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fc1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{(}\PY{n}{outLayers}\PY{p}{)}
    \PY{n}{outLayers} \PY{o}{=} \PY{n}{Dense}\PY{p}{(}\PY{l+m+mi}{4096}\PY{p}{,} \PY{n}{activation}\PY{o}{=}\PY{n}{layerType}\PY{p}{,} \PY{n}{name}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fc2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{(}\PY{n}{outLayers}\PY{p}{)}
    \PY{n}{outLayers} \PY{o}{=} \PY{n}{Dense}\PY{p}{(}\PY{n}{classes}\PY{p}{,} \PY{n}{activation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{softmax}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{name}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{predictions}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{(}\PY{n}{outLayers}\PY{p}{)}

    \PY{n}{newModel} \PY{o}{=} \PY{n}{Model}\PY{p}{(}\PY{n}{name} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{My Model}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{inputs} \PY{o}{=} \PY{n}{inputShape}\PY{p}{,} \PY{n}{outputs} \PY{o}{=} \PY{n}{outLayers}\PY{p}{)}
    \PY{n}{newModel}\PY{o}{.}\PY{n}{compile}\PY{p}{(}\PY{n}{loss}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sparse\PYZus{}categorical\PYZus{}crossentropy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{optimizer}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{adam}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{metrics}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{accuracy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
    \PY{k}{return} \PY{n}{newModel}        

\PY{c+c1}{\PYZsh{}inputData, labels = createDataset()}
\PY{c+c1}{\PYZsh{}inputData = np.array(inputData)}
\PY{c+c1}{\PYZsh{}labels = np.array(labels)}


\PY{c+c1}{\PYZsh{}trainData, trainValue, labelsData, labelsValue = train\PYZus{}test\PYZus{}split(inputData, labels, test\PYZus{}size = 0.20, random\PYZus{}state = 2)}
\PY{c+c1}{\PYZsh{}print(\PYZsq{}Conjunto\PYZsq{})}
\PY{n}{trainingSet} \PY{o}{=} \PY{n}{generateTraining}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{F:/data/train/}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{c+c1}{\PYZsh{}print(\PYZsq{}Modelo\PYZsq{})}
\PY{n}{myModel} \PY{o}{=} \PY{n}{loadModel}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{relu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{c+c1}{\PYZsh{}myModel = VGG16(weights=\PYZsq{}imagenet\PYZsq{}, include\PYZus{}top=True)}
\PY{n}{myModel}\PY{o}{.}\PY{n}{summary}\PY{p}{(}\PY{p}{)}
\PY{c+c1}{\PYZsh{}myModel.compile(loss=\PYZsq{}sparse\PYZus{}categorical\PYZus{}crossentropy\PYZsq{}, optimizer=\PYZsq{}adam\PYZsq{}, metrics=[\PYZsq{}accuracy\PYZsq{}])}
\PY{c+c1}{\PYZsh{}print(\PYZsq{}Treino\PYZsq{})}
\PY{c+c1}{\PYZsh{}samples = trainset}
\PY{n}{history} \PY{o}{=} \PY{n}{myModel}\PY{o}{.}\PY{n}{fit\PYZus{}generator}\PY{p}{(}\PY{n}{trainingSet}\PY{p}{,}
                                 \PY{n}{steps\PYZus{}per\PYZus{}epoch}\PY{o}{=}\PY{n+nb}{int}\PY{p}{(}\PY{n}{trainingSet}\PY{o}{.}\PY{n}{samples}\PY{o}{/}\PY{n}{batchSize}\PY{p}{)}\PY{p}{,}
                                 \PY{n}{epochs} \PY{o}{=} \PY{l+m+mi}{16}\PY{p}{,}
                                 \PY{n}{verbose} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{)}
\PY{c+c1}{\PYZsh{}print(\PYZsq{}Treinado\PYZsq{})}
\PY{n}{acc} \PY{o}{=} \PY{n}{history}\PY{o}{.}\PY{n}{history}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{acc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{val\PYZus{}acc} \PY{o}{=} \PY{n}{history}\PY{o}{.}\PY{n}{history}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{val\PYZus{}acc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{loss} \PY{o}{=} \PY{n}{history}\PY{o}{.}\PY{n}{history}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{loss}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{val\PYZus{}loss} \PY{o}{=} \PY{n}{history}\PY{o}{.}\PY{n}{history}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{val\PYZus{}loss}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}

\PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
\PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline

\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{epochs}\PY{p}{,} \PY{n}{acc}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Training}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{epochs}\PY{p}{,} \PY{n}{val\PYZus{}acc}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Validation}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Accuracy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{tensorflow} \PY{k}{as} \PY{n+nn}{tf}

\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{models} \PY{k}{import} \PY{n}{Sequential}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers} \PY{k}{import} \PY{n}{Convolution2D}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers} \PY{k}{import} \PY{n}{MaxPooling2D}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers} \PY{k}{import} \PY{n}{Flatten}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers} \PY{k}{import} \PY{n}{Dense}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras} \PY{k}{import} \PY{n}{applications}

\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers} \PY{k}{import} \PY{n}{Input}\PY{p}{,} \PY{n}{Flatten}\PY{p}{,} \PY{n}{Dense}
\PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{models} \PY{k}{import} \PY{n}{Model}

\PY{k+kn}{from} \PY{n+nn}{datetime} \PY{k}{import} \PY{n}{datetime}

\PY{k+kn}{import} \PY{n+nn}{os}

\PY{n}{batchSize} \PY{o}{=} \PY{l+m+mi}{1}

\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Imports}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{classifier}\PY{o}{=}\PY{n}{tf}\PY{o}{.}\PY{n}{keras}\PY{o}{.}\PY{n}{Sequential}\PY{p}{(}\PY{p}{)}   \PY{c+c1}{\PYZsh{} Intialializing CNN}

\PY{n}{shape} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{244}\PY{p}{,} \PY{l+m+mi}{244}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{)}
\PY{n}{vggModel}\PY{o}{=}\PY{n}{tf}\PY{o}{.}\PY{n}{keras}\PY{o}{.}\PY{n}{applications}\PY{o}{.}\PY{n}{VGG16}\PY{p}{(}\PY{n}{input\PYZus{}shape}\PY{o}{=}\PY{n}{shape}\PY{p}{,}
                                               \PY{n}{include\PYZus{}top}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,}
                                               \PY{n}{weights}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{imagenet}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{classifier}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{vggModel}\PY{p}{)}

\PY{c+c1}{\PYZsh{}Flattening Step}
\PY{n}{classifier}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Flatten}\PY{p}{(}\PY{p}{)}\PY{p}{)} 

\PY{c+c1}{\PYZsh{}Full Connection Step}
\PY{n}{classifier}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dense}\PY{p}{(}\PY{l+m+mi}{4096}\PY{p}{,}\PY{n}{activation} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{relu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
\PY{n}{classifier}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dense}\PY{p}{(}\PY{l+m+mi}{4096}\PY{p}{,}\PY{n}{activation} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{relu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}  
\PY{n}{classifier}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dense}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{activation} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{softmax}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}

\PY{c+c1}{\PYZsh{}Compiling CNN}
\PY{n}{classifier}\PY{o}{.}\PY{n}{compile}\PY{p}{(}\PY{n}{optimizer} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{adam}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{loss} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{binary\PYZus{}crossentropy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{metrics} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{accuracy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{classifier}\PY{o}{.}\PY{n}{summary}\PY{p}{(}\PY{p}{)}

\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{preprocessing}\PY{n+nn}{.}\PY{n+nn}{image} \PY{k}{import} \PY{n}{ImageDataGenerator}

\PY{n}{path}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{F:/Workspace/Test/input/training\PYZus{}set}\PY{l+s+s2}{\PYZdq{}}

\PY{n}{train\PYZus{}datagen} \PY{o}{=} \PY{n}{ImageDataGenerator}\PY{p}{(}\PY{n}{rescale}\PY{o}{=}\PY{l+m+mf}{1.}\PY{o}{/}\PY{l+m+mi}{255}\PY{p}{)}

\PY{n}{test\PYZus{}datagen} \PY{o}{=} \PY{n}{ImageDataGenerator}\PY{p}{(}\PY{n}{rescale}\PY{o}{=}\PY{l+m+mf}{1.}\PY{o}{/}\PY{l+m+mi}{255}\PY{p}{)}


\PY{n}{training\PYZus{}set} \PY{o}{=} \PY{n}{train\PYZus{}datagen}\PY{o}{.}\PY{n}{flow\PYZus{}from\PYZus{}directory}\PY{p}{(} \PY{n}{path}\PY{p}{,}
                                                    \PY{n}{target\PYZus{}size}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{244}\PY{p}{,} \PY{l+m+mi}{244}\PY{p}{)}\PY{p}{,}
                                                    \PY{n}{batch\PYZus{}size}\PY{o}{=}\PY{n}{batchSize}\PY{p}{,}
                                                    \PY{n}{class\PYZus{}mode}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{binary}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{path}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{F:/Workspace/Test/input/validation}\PY{l+s+s2}{\PYZdq{}}

\PY{n}{test\PYZus{}set} \PY{o}{=} \PY{n}{test\PYZus{}datagen}\PY{o}{.}\PY{n}{flow\PYZus{}from\PYZus{}directory}\PY{p}{(}
                                              \PY{n}{path}\PY{p}{,}
                                              \PY{n}{target\PYZus{}size}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{244}\PY{p}{,}\PY{l+m+mi}{244}\PY{p}{)}\PY{p}{,}
                                              \PY{n}{batch\PYZus{}size}\PY{o}{=}\PY{n}{batchSize}\PY{p}{,}
                                              \PY{n}{class\PYZus{}mode}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{binary}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{now} \PY{o}{=} \PY{n}{datetime}\PY{o}{.}\PY{n}{now}\PY{p}{(}\PY{p}{)}
\PY{n}{timestamp} \PY{o}{=} \PY{n}{datetime}\PY{o}{.}\PY{n}{timestamp}\PY{p}{(}\PY{n}{now}\PY{p}{)}

\PY{n}{dt\PYZus{}string} \PY{o}{=} \PY{n}{now}\PY{o}{.}\PY{n}{strftime}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{m/}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{Y }\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{H:}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{M:}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{S}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Starting date and time =}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{dt\PYZus{}string}\PY{p}{)}

\PY{n}{epochs} \PY{o}{=} \PY{l+m+mi}{50}
\PY{n}{steps} \PY{o}{=} \PY{l+m+mi}{100}
\PY{n}{checkpoint\PYZus{}path} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{F:/Workspace/Test/input/checkpoints/cp.ckpt}\PY{l+s+s2}{\PYZdq{}}

\PY{c+c1}{\PYZsh{} Create a callback that saves the model\PYZsq{}s weights}
\PY{n}{cp} \PY{o}{=} \PY{n}{tf}\PY{o}{.}\PY{n}{keras}\PY{o}{.}\PY{n}{callbacks}\PY{o}{.}\PY{n}{ModelCheckpoint}\PY{p}{(}\PY{n}{filepath}\PY{o}{=}\PY{n}{checkpoint\PYZus{}path}\PY{p}{,}
                                                 \PY{n}{save\PYZus{}weights\PYZus{}only}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}
                                                 \PY{n}{verbose}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}

\PY{c+c1}{\PYZsh{}Quando testar no servidor, alterar para mais épocas e passos}
\PY{n}{history} \PY{o}{=} \PY{n}{classifier}\PY{o}{.}\PY{n}{fit\PYZus{}generator}\PY{p}{(}
        \PY{n}{training\PYZus{}set}\PY{p}{,}
        \PY{n}{steps\PYZus{}per\PYZus{}epoch}\PY{o}{=}\PY{n}{steps}\PY{p}{,}
        \PY{n}{epochs}\PY{o}{=}\PY{n}{epochs}\PY{p}{,}
        \PY{n}{validation\PYZus{}data}\PY{o}{=}\PY{n}{test\PYZus{}set}\PY{p}{,}
        \PY{n}{validation\PYZus{}steps}\PY{o}{=}\PY{n}{steps}\PY{p}{,} 
        \PY{n}{callbacks} \PY{o}{=} \PY{p}{[}\PY{n}{cp}\PY{p}{]}\PY{p}{)}

\PY{n}{now} \PY{o}{=} \PY{n}{datetime}\PY{o}{.}\PY{n}{now}\PY{p}{(}\PY{p}{)}
\PY{n}{timestamp} \PY{o}{=} \PY{n}{datetime}\PY{o}{.}\PY{n}{timestamp}\PY{p}{(}\PY{n}{now}\PY{p}{)}

\PY{n}{dt\PYZus{}string} \PY{o}{=} \PY{n}{now}\PY{o}{.}\PY{n}{strftime}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{m/}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{Y }\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{H:}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{M:}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{S}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Finish date and time =}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{dt\PYZus{}string}\PY{p}{)}

\PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
\PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline

\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{roc\PYZus{}curve}\PY{p}{,}\PY{n}{roc\PYZus{}auc\PYZus{}score}

\PY{n}{path} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{F:/Workspace/Test/input/test}\PY{l+s+s2}{\PYZdq{}}
\PY{n}{test\PYZus{}generator} \PY{o}{=} \PY{n}{test\PYZus{}datagen}\PY{o}{.}\PY{n}{flow\PYZus{}from\PYZus{}directory}\PY{p}{(}
                                              \PY{n}{path}\PY{p}{,}
                                              \PY{n}{target\PYZus{}size}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{244}\PY{p}{,}\PY{l+m+mi}{244}\PY{p}{)}\PY{p}{,}
                                              \PY{n}{batch\PYZus{}size}\PY{o}{=}\PY{n}{batchSize}\PY{p}{,}
                                              \PY{n}{class\PYZus{}mode}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{binary}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{trueValues} \PY{o}{=} \PY{n}{test\PYZus{}generator}\PY{o}{.}\PY{n}{classes}

\PY{n}{predictions} \PY{o}{=} \PY{n}{classifier}\PY{o}{.}\PY{n}{predict\PYZus{}generator}\PY{p}{(}\PY{n}{test\PYZus{}generator}\PY{p}{,}\PY{n}{steps} \PY{o}{=} \PY{l+m+mi}{609}\PY{p}{,}\PY{n}{verbose}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}

\PY{n}{fpr}\PY{p}{,} \PY{n}{tpr}\PY{p}{,} \PY{n}{thresholds} \PY{o}{=} \PY{n}{roc\PYZus{}curve} \PY{p}{(}\PY{n}{trueValues} \PY{p}{,} \PY{n}{predictions}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{fpr}\PY{p}{,}\PY{n}{tpr}\PY{p}{)} 
\PY{n}{plt}\PY{o}{.}\PY{n}{axis}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)} 
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{False Positive Rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} 
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{True Positive Rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} 
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{tensorflow} \PY{k}{as} \PY{n+nn}{tf}

\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{models} \PY{k}{import} \PY{n}{Sequential}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers} \PY{k}{import} \PY{n}{Convolution2D}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers} \PY{k}{import} \PY{n}{MaxPooling2D}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers} \PY{k}{import} \PY{n}{Flatten}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers} \PY{k}{import} \PY{n}{Dense}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras} \PY{k}{import} \PY{n}{applications}

\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers} \PY{k}{import} \PY{n}{Input}\PY{p}{,} \PY{n}{Flatten}\PY{p}{,} \PY{n}{Dense}
\PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{models} \PY{k}{import} \PY{n}{Model}

\PY{k+kn}{from} \PY{n+nn}{datetime} \PY{k}{import} \PY{n}{datetime}

\PY{k+kn}{import} \PY{n+nn}{os}

\PY{n}{batchSize} \PY{o}{=} \PY{l+m+mi}{32}

\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Imports}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{classifier}\PY{o}{=}\PY{n}{tf}\PY{o}{.}\PY{n}{keras}\PY{o}{.}\PY{n}{Sequential}\PY{p}{(}\PY{p}{)}   \PY{c+c1}{\PYZsh{} Intialializing CNN}

\PY{n}{shape} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{244}\PY{p}{,} \PY{l+m+mi}{244}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{)}
\PY{n}{vggModel}\PY{o}{=}\PY{n}{tf}\PY{o}{.}\PY{n}{keras}\PY{o}{.}\PY{n}{applications}\PY{o}{.}\PY{n}{VGG16}\PY{p}{(}\PY{n}{input\PYZus{}shape}\PY{o}{=}\PY{n}{shape}\PY{p}{,}
                                               \PY{n}{include\PYZus{}top}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,}
                                               \PY{n}{weights}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{imagenet}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{classifier}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{vggModel}\PY{p}{)}

\PY{c+c1}{\PYZsh{}Flattening Step}
\PY{n}{classifier}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Flatten}\PY{p}{(}\PY{p}{)}\PY{p}{)} 

\PY{c+c1}{\PYZsh{}Full Connection Step}
\PY{n}{classifier}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dense}\PY{p}{(}\PY{l+m+mi}{4096}\PY{p}{,}\PY{n}{activation} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{relu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
\PY{n}{classifier}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dense}\PY{p}{(}\PY{l+m+mi}{4096}\PY{p}{,}\PY{n}{activation} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{relu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}  
\PY{n}{classifier}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dense}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{activation} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{softmax}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}

\PY{c+c1}{\PYZsh{}Compiling CNN}
\PY{n}{classifier}\PY{o}{.}\PY{n}{compile}\PY{p}{(}\PY{n}{optimizer} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{adam}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{loss} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{binary\PYZus{}crossentropy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{metrics} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{accuracy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{classifier}\PY{o}{.}\PY{n}{summary}\PY{p}{(}\PY{p}{)}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{preprocessing}\PY{n+nn}{.}\PY{n+nn}{image} \PY{k}{import} \PY{n}{ImageDataGenerator}

\PY{n}{path}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{F:/Workspace/Test/input/training\PYZus{}set}\PY{l+s+s2}{\PYZdq{}}

\PY{n}{train\PYZus{}datagen} \PY{o}{=} \PY{n}{ImageDataGenerator}\PY{p}{(}\PY{n}{rescale}\PY{o}{=}\PY{l+m+mf}{1.}\PY{o}{/}\PY{l+m+mi}{255}\PY{p}{)}

\PY{n}{test\PYZus{}datagen} \PY{o}{=} \PY{n}{ImageDataGenerator}\PY{p}{(}\PY{n}{rescale}\PY{o}{=}\PY{l+m+mf}{1.}\PY{o}{/}\PY{l+m+mi}{255}\PY{p}{)}


\PY{n}{training\PYZus{}set} \PY{o}{=} \PY{n}{train\PYZus{}datagen}\PY{o}{.}\PY{n}{flow\PYZus{}from\PYZus{}directory}\PY{p}{(} \PY{n}{path}\PY{p}{,}
                                                    \PY{n}{target\PYZus{}size}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{244}\PY{p}{,} \PY{l+m+mi}{244}\PY{p}{)}\PY{p}{,}
                                                    \PY{n}{batch\PYZus{}size}\PY{o}{=}\PY{n}{batchSize}\PY{p}{,}
                                                    \PY{n}{class\PYZus{}mode}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{binary}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{path}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{F:/Workspace/Test/input/validation}\PY{l+s+s2}{\PYZdq{}}

\PY{n}{validSet} \PY{o}{=} \PY{n}{test\PYZus{}datagen}\PY{o}{.}\PY{n}{flow\PYZus{}from\PYZus{}directory}\PY{p}{(}
                                              \PY{n}{path}\PY{p}{,}
                                              \PY{n}{target\PYZus{}size}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{244}\PY{p}{,}\PY{l+m+mi}{244}\PY{p}{)}\PY{p}{,}
                                              \PY{n}{batch\PYZus{}size}\PY{o}{=}\PY{n}{batchSize}\PY{p}{,}
                                              \PY{n}{class\PYZus{}mode}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{binary}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{now} \PY{o}{=} \PY{n}{datetime}\PY{o}{.}\PY{n}{now}\PY{p}{(}\PY{p}{)}
\PY{n}{timestamp} \PY{o}{=} \PY{n}{datetime}\PY{o}{.}\PY{n}{timestamp}\PY{p}{(}\PY{n}{now}\PY{p}{)}

\PY{n}{dt\PYZus{}string} \PY{o}{=} \PY{n}{now}\PY{o}{.}\PY{n}{strftime}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{m/}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{Y }\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{H:}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{M:}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{S}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Starting date and time =}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{dt\PYZus{}string}\PY{p}{)}
\PY{n}{epochs} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{steps} \PY{o}{=} \PY{l+m+mi}{50}
\PY{n}{checkpoint\PYZus{}path} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{F:/Workspace/Test/checkpoints/cp.ckpt}\PY{l+s+s2}{\PYZdq{}}
\PY{n}{checkpoint\PYZus{}dir} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{dirname}\PY{p}{(}\PY{n}{checkpoint\PYZus{}path}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Create a callback that saves the model\PYZsq{}s weights}
\PY{n}{cp} \PY{o}{=} \PY{n}{tf}\PY{o}{.}\PY{n}{keras}\PY{o}{.}\PY{n}{callbacks}\PY{o}{.}\PY{n}{ModelCheckpoint}\PY{p}{(}\PY{n}{filepath}\PY{o}{=}\PY{n}{checkpoint\PYZus{}path}\PY{p}{,}
                                                 \PY{n}{save\PYZus{}weights\PYZus{}only}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}
                                                 \PY{n}{verbose}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}

\PY{c+c1}{\PYZsh{}Quando testar no servidor, alterar para mais épocas e passos}
\PY{n}{validSteps} \PY{o}{=} \PY{l+m+mi}{20}



\PY{n}{loss}\PY{p}{,} \PY{n}{acc} \PY{o}{=} \PY{n}{classifier}\PY{o}{.}\PY{n}{evaluate\PYZus{}generator}\PY{p}{(}\PY{n}{generator}\PY{o}{=}\PY{n}{validSet}\PY{p}{,}\PY{n}{steps}\PY{o}{=}\PY{n}{steps}\PY{p}{)}

\PY{c+c1}{\PYZsh{}loss, acc = classifier.evaluate(validSet,  validSet.classes, verbose=2)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Untrained model, accuracy: }\PY{l+s+si}{\PYZob{}:5.2f\PYZcb{}}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{l+m+mi}{100}\PY{o}{*}\PY{n}{acc}\PY{p}{)}\PY{p}{)}


\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{)}\PY{p}{:} 
    \PY{n}{latest} \PY{o}{=} \PY{n}{tf}\PY{o}{.}\PY{n}{train}\PY{o}{.}\PY{n}{latest\PYZus{}checkpoint}\PY{p}{(}\PY{n}{checkpoint\PYZus{}dir}\PY{p}{)}
    \PY{n}{classifier}\PY{o}{.}\PY{n}{load\PYZus{}weights}\PY{p}{(}\PY{n}{latest}\PY{p}{)}
    
    \PY{n}{history} \PY{o}{=} \PY{n}{classifier}\PY{o}{.}\PY{n}{fit\PYZus{}generator}\PY{p}{(}
        \PY{n}{training\PYZus{}set}\PY{p}{,}
        \PY{n}{steps\PYZus{}per\PYZus{}epoch}\PY{o}{=}\PY{n}{steps}\PY{p}{,}
        \PY{n}{epochs}\PY{o}{=}\PY{n}{epochs}\PY{p}{,}
        \PY{n}{validation\PYZus{}data}\PY{o}{=}\PY{n}{validSet}\PY{p}{,}
        \PY{n}{validation\PYZus{}steps}\PY{o}{=}\PY{n}{validSteps}\PY{p}{,} 
        \PY{n}{callbacks} \PY{o}{=} \PY{p}{[}\PY{n}{cp}\PY{p}{]}\PY{p}{)}
    
    \PY{n}{acc} \PY{o}{=} \PY{n}{history}\PY{o}{.}\PY{n}{history}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{accuracy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
    \PY{n}{val\PYZus{}acc} \PY{o}{=} \PY{n}{history}\PY{o}{.}\PY{n}{history}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{val\PYZus{}accuracy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
    \PY{n}{loss} \PY{o}{=} \PY{n}{history}\PY{o}{.}\PY{n}{history}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{loss}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
    \PY{n}{val\PYZus{}loss} \PY{o}{=} \PY{n}{history}\PY{o}{.}\PY{n}{history}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{val\PYZus{}loss}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}


    \PY{n}{savePath} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{F:/Workspace/Test/checkpoints/myModel}\PY{l+s+si}{\PYZob{}epoch:04d\PYZcb{}}\PY{l+s+s1}{.h5}\PY{l+s+s1}{\PYZsq{}}
    \PY{n}{classifier}\PY{o}{.}\PY{n}{save}\PY{p}{(}\PY{n}{savePath}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{epoch}\PY{o}{=}\PY{n}{i}\PY{p}{)}\PY{p}{)} 

\PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}

\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{epochs}\PY{p}{,} \PY{n}{acc}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Training}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{epochs}\PY{p}{,} \PY{n}{val\PYZus{}acc}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Validation}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Accuracy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}

\PY{n}{now} \PY{o}{=} \PY{n}{datetime}\PY{o}{.}\PY{n}{now}\PY{p}{(}\PY{p}{)}
\PY{n}{timestamp} \PY{o}{=} \PY{n}{datetime}\PY{o}{.}\PY{n}{timestamp}\PY{p}{(}\PY{n}{now}\PY{p}{)}

\PY{n}{dt\PYZus{}string} \PY{o}{=} \PY{n}{now}\PY{o}{.}\PY{n}{strftime}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{m/}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{Y }\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{H:}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{M:}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{S}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Finish date and time =}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{dt\PYZus{}string}\PY{p}{)}


\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{roc\PYZus{}curve}\PY{p}{,}\PY{n}{roc\PYZus{}auc\PYZus{}score}

\PY{n}{path} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{F:/Workspace/Test/input/test}\PY{l+s+s2}{\PYZdq{}}
\PY{n}{test\PYZus{}generator} \PY{o}{=} \PY{n}{test\PYZus{}datagen}\PY{o}{.}\PY{n}{flow\PYZus{}from\PYZus{}directory}\PY{p}{(}
                                              \PY{n}{path}\PY{p}{,}
                                              \PY{n}{target\PYZus{}size}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{244}\PY{p}{,}\PY{l+m+mi}{244}\PY{p}{)}\PY{p}{,}
                                              \PY{n}{batch\PYZus{}size}\PY{o}{=}\PY{n}{batchSize}\PY{p}{,}
                                              \PY{n}{class\PYZus{}mode}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{binary}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}


\PY{n}{trueValues} \PY{o}{=} \PY{n}{test\PYZus{}generator}\PY{o}{.}\PY{n}{classes}
\PY{n}{predSteps} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{test\PYZus{}generator}\PY{o}{.}\PY{n}{classes}\PY{p}{)} \PY{o}{/} \PY{n}{batchSize}
\PY{n}{predictions} \PY{o}{=} \PY{n}{classifier}\PY{o}{.}\PY{n}{predict\PYZus{}generator}\PY{p}{(}\PY{n}{test\PYZus{}generator}\PY{p}{,}\PY{n}{steps} \PY{o}{=} \PY{n}{predSteps}\PY{p}{,}\PY{n}{verbose}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}

\PY{n}{fpr}\PY{p}{,} \PY{n}{tpr}\PY{p}{,} \PY{n}{thresholds} \PY{o}{=} \PY{n}{roc\PYZus{}curve} \PY{p}{(}\PY{n}{trueValues} \PY{p}{,} \PY{n}{predictions}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{fpr}\PY{p}{,}\PY{n}{tpr}\PY{p}{)} 
\PY{n}{plt}\PY{o}{.}\PY{n}{axis}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)} 
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{False Positive Rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} 
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{True Positive Rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} 
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
\PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline

\PY{k+kn}{import} \PY{n+nn}{random}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{start}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{fpr} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mf}{0.14492754}\PY{p}{,}\PY{l+m+mf}{0.15942029}\PY{p}{,}\PY{l+m+mf}{0.20289855}\PY{p}{,}\PY{l+m+mf}{0.21014493}\PY{p}{,}\PY{l+m+mf}{0.24637681}
\PY{p}{,}\PY{l+m+mf}{0.24637681}\PY{p}{,}\PY{l+m+mf}{0.26086957}\PY{p}{,}\PY{l+m+mf}{0.26811594}\PY{p}{,}\PY{l+m+mf}{0.2826087}\PY{p}{,}\PY{l+m+mf}{0.2826087}\PY{p}{,}\PY{l+m+mf}{0.2826087}
\PY{p}{,}\PY{l+m+mf}{0.28985507}\PY{p}{,}\PY{l+m+mf}{0.28985507}\PY{p}{,}\PY{l+m+mf}{0.28985507}\PY{p}{,}\PY{l+m+mf}{0.28985507}\PY{p}{,}\PY{l+m+mf}{0.29710145}\PY{p}{,}\PY{l+m+mf}{0.30434783}
\PY{p}{,}\PY{l+m+mf}{0.30434783}\PY{p}{,}\PY{l+m+mf}{0.3115942}\PY{p}{,}\PY{l+m+mf}{0.31884058}\PY{p}{,}\PY{l+m+mf}{0.32608696}\PY{p}{,}\PY{l+m+mf}{0.33333333}\PY{p}{,}\PY{l+m+mf}{0.33333333}
\PY{p}{,}\PY{l+m+mf}{0.34057971}\PY{p}{,}\PY{l+m+mf}{0.34057971}\PY{p}{,}\PY{l+m+mf}{0.34057971}\PY{p}{,}\PY{l+m+mf}{0.34782609}\PY{p}{,}\PY{l+m+mf}{0.34782609}\PY{p}{,}\PY{l+m+mf}{0.35507246}
\PY{p}{,}\PY{l+m+mf}{0.35507246}\PY{p}{,}\PY{l+m+mf}{0.35507246}\PY{p}{,}\PY{l+m+mf}{0.36956522}\PY{p}{,}\PY{l+m+mf}{0.36956522}\PY{p}{,}\PY{l+m+mf}{0.36956522}\PY{p}{,}\PY{l+m+mf}{0.36956522}
\PY{p}{,}\PY{l+m+mf}{0.37681159}\PY{p}{,}\PY{l+m+mf}{0.37681159}\PY{p}{,}\PY{l+m+mf}{0.38405797}\PY{p}{,}\PY{l+m+mf}{0.38405797}\PY{p}{,}\PY{l+m+mf}{0.38405797}\PY{p}{,}\PY{l+m+mf}{0.38405797}
\PY{p}{,}\PY{l+m+mf}{0.39130435}\PY{p}{,}\PY{l+m+mf}{0.39130435}\PY{p}{,}\PY{l+m+mf}{0.39855072}\PY{p}{,}\PY{l+m+mf}{0.39855072}\PY{p}{,}\PY{l+m+mf}{0.39855072}\PY{p}{,}\PY{l+m+mf}{0.41304348}
\PY{p}{,}\PY{l+m+mf}{0.41304348}\PY{p}{,}\PY{l+m+mf}{0.42753623}\PY{p}{,}\PY{l+m+mf}{0.42753623}\PY{p}{,}\PY{l+m+mf}{0.42753623}\PY{p}{,}\PY{l+m+mf}{0.42753623}\PY{p}{,}\PY{l+m+mf}{0.43478261}
\PY{p}{,}\PY{l+m+mf}{0.43478261}\PY{p}{,}\PY{l+m+mf}{0.46376812}\PY{p}{,}\PY{l+m+mf}{0.46376812}\PY{p}{,}\PY{l+m+mf}{0.47826087}\PY{p}{,}\PY{l+m+mf}{0.47826087}\PY{p}{,}\PY{l+m+mf}{0.48550725}
\PY{p}{,}\PY{l+m+mf}{0.48550725}\PY{p}{,}\PY{l+m+mf}{0.5}\PY{p}{,}\PY{l+m+mf}{0.5}\PY{p}{,}\PY{l+m+mf}{0.52173913}\PY{p}{,}\PY{l+m+mf}{0.52173913}\PY{p}{,}\PY{l+m+mf}{0.52898551}
\PY{p}{,}\PY{l+m+mf}{0.52898551}\PY{p}{,}\PY{l+m+mf}{0.53623188}\PY{p}{,}\PY{l+m+mf}{0.53623188}\PY{p}{,}\PY{l+m+mf}{0.54347826}\PY{p}{,}\PY{l+m+mf}{0.54347826}\PY{p}{,}\PY{l+m+mf}{0.55072464}
\PY{p}{,}\PY{l+m+mf}{0.55072464}\PY{p}{,}\PY{l+m+mf}{0.55797101}\PY{p}{,}\PY{l+m+mf}{0.55797101}\PY{p}{,}\PY{l+m+mf}{0.56521739}\PY{p}{,}\PY{l+m+mf}{0.56521739}\PY{p}{,}\PY{l+m+mf}{0.57246377}
\PY{p}{,}\PY{l+m+mf}{0.57246377}\PY{p}{,}\PY{l+m+mf}{0.57971014}\PY{p}{,}\PY{l+m+mf}{0.57971014}\PY{p}{,}\PY{l+m+mf}{0.58695652}\PY{p}{,}\PY{l+m+mf}{0.58695652}\PY{p}{,}\PY{l+m+mf}{0.5942029}
\PY{p}{,}\PY{l+m+mf}{0.5942029}\PY{p}{,}\PY{l+m+mf}{0.60144928}\PY{p}{,}\PY{l+m+mf}{0.60144928}\PY{p}{,}\PY{l+m+mf}{0.60869565}\PY{p}{,}\PY{l+m+mf}{0.60869565}\PY{p}{,}\PY{l+m+mf}{0.62318841}
\PY{p}{,}\PY{l+m+mf}{0.62318841}\PY{p}{,}\PY{l+m+mf}{0.63043478}\PY{p}{,}\PY{l+m+mf}{0.63043478}\PY{p}{,}\PY{l+m+mf}{0.63768116}\PY{p}{,}\PY{l+m+mf}{0.63768116}\PY{p}{,}\PY{l+m+mf}{0.64492754}
\PY{p}{,}\PY{l+m+mf}{0.64492754}\PY{p}{,}\PY{l+m+mf}{0.65217391}\PY{p}{,}\PY{l+m+mf}{0.65217391}\PY{p}{,}\PY{l+m+mf}{0.65942029}\PY{p}{,}\PY{l+m+mf}{0.65942029}\PY{p}{,}\PY{l+m+mf}{0.66666667}
\PY{p}{,}\PY{l+m+mf}{0.66666667}\PY{p}{,}\PY{l+m+mf}{0.67391304}\PY{p}{,}\PY{l+m+mf}{0.67391304}\PY{p}{,}\PY{l+m+mf}{0.68115942}\PY{p}{,}\PY{l+m+mf}{0.68115942}\PY{p}{,}\PY{l+m+mf}{0.6884058}
\PY{p}{,}\PY{l+m+mf}{0.6884058}\PY{p}{,}\PY{l+m+mf}{0.69565217}\PY{p}{,}\PY{l+m+mf}{0.69565217}\PY{p}{,}\PY{l+m+mf}{0.70289855}\PY{p}{,}\PY{l+m+mf}{0.70289855}\PY{p}{,}\PY{l+m+mf}{0.71014493}
\PY{p}{,}\PY{l+m+mf}{0.71014493}\PY{p}{,}\PY{l+m+mf}{0.7173913}\PY{p}{,}\PY{l+m+mf}{0.7173913}\PY{p}{,}\PY{l+m+mf}{0.72463768}\PY{p}{,}\PY{l+m+mf}{0.72463768}\PY{p}{,}\PY{l+m+mf}{0.73188406}
\PY{p}{,}\PY{l+m+mf}{0.73188406}\PY{p}{,}\PY{l+m+mf}{0.73913043}\PY{p}{,}\PY{l+m+mf}{0.73913043}\PY{p}{,}\PY{l+m+mf}{0.75362319}\PY{p}{,}\PY{l+m+mf}{0.75362319}\PY{p}{,}\PY{l+m+mf}{0.76086957}
\PY{p}{,}\PY{l+m+mf}{0.76086957}\PY{p}{,}\PY{l+m+mf}{0.76811594}\PY{p}{,}\PY{l+m+mf}{0.76811594}\PY{p}{,}\PY{l+m+mf}{0.77536232}\PY{p}{,}\PY{l+m+mf}{0.77536232}\PY{p}{,}\PY{l+m+mf}{0.7826087}
\PY{p}{,}\PY{l+m+mf}{0.7826087}\PY{p}{,}\PY{l+m+mf}{0.78985507}\PY{p}{,}\PY{l+m+mf}{0.78985507}\PY{p}{,}\PY{l+m+mf}{0.80434783}\PY{p}{,}\PY{l+m+mf}{0.80434783}\PY{p}{,}\PY{l+m+mf}{0.8115942}
\PY{p}{,}\PY{l+m+mf}{0.8115942}\PY{p}{,}\PY{l+m+mf}{0.82608696}\PY{p}{,}\PY{l+m+mf}{0.82608696}\PY{p}{,}\PY{l+m+mf}{0.83333333}\PY{p}{,}\PY{l+m+mf}{0.83333333}\PY{p}{,}\PY{l+m+mf}{0.84057971}
\PY{p}{,}\PY{l+m+mf}{0.84057971}\PY{p}{,}\PY{l+m+mf}{0.84782609}\PY{p}{,}\PY{l+m+mf}{0.84782609}\PY{p}{,}\PY{l+m+mf}{0.84782609}\PY{p}{,}\PY{l+m+mf}{0.84782609}\PY{p}{,}\PY{l+m+mf}{0.85507246}
\PY{p}{,}\PY{l+m+mf}{0.85507246}\PY{p}{,}\PY{l+m+mf}{0.86231884}\PY{p}{,}\PY{l+m+mf}{0.86231884}\PY{p}{,}\PY{l+m+mf}{0.86231884}\PY{p}{,}\PY{l+m+mf}{0.86231884}\PY{p}{,}\PY{l+m+mf}{0.86956522}
\PY{p}{,}\PY{l+m+mf}{0.86956522}\PY{p}{,}\PY{l+m+mf}{0.88405797}\PY{p}{,}\PY{l+m+mf}{0.9057971}\PY{p}{,}\PY{l+m+mf}{0.9057971}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}

\PY{n}{tpr} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mf}{0.18259023}\PY{p}{,}\PY{l+m+mf}{0.19957537}\PY{p}{,}\PY{l+m+mf}{0.24416136}\PY{p}{,}\PY{l+m+mf}{0.24840764}\PY{p}{,}\PY{l+m+mf}{0.28025478}
\PY{p}{,}\PY{l+m+mf}{0.28450106}\PY{p}{,}\PY{l+m+mf}{0.29511677}\PY{p}{,}\PY{l+m+mf}{0.29936306}\PY{p}{,}\PY{l+m+mf}{0.30573248}\PY{p}{,}\PY{l+m+mf}{0.31847134}\PY{p}{,}\PY{l+m+mf}{0.32059448}
\PY{p}{,}\PY{l+m+mf}{0.32059448}\PY{p}{,}\PY{l+m+mf}{0.32271762}\PY{p}{,}\PY{l+m+mf}{0.32696391}\PY{p}{,}\PY{l+m+mf}{0.33757962}\PY{p}{,}\PY{l+m+mf}{0.3418259}\PY{p}{,}\PY{l+m+mf}{0.34394904}
\PY{p}{,}\PY{l+m+mf}{0.34607219}\PY{p}{,}\PY{l+m+mf}{0.34819533}\PY{p}{,}\PY{l+m+mf}{0.35244161}\PY{p}{,}\PY{l+m+mf}{0.35244161}\PY{p}{,}\PY{l+m+mf}{0.3566879}\PY{p}{,}\PY{l+m+mf}{0.36730361}
\PY{p}{,}\PY{l+m+mf}{0.36942675}\PY{p}{,}\PY{l+m+mf}{0.37367304}\PY{p}{,}\PY{l+m+mf}{0.37791932}\PY{p}{,}\PY{l+m+mf}{0.38216561}\PY{p}{,}\PY{l+m+mf}{0.40127389}\PY{p}{,}\PY{l+m+mf}{0.40339703}
\PY{p}{,}\PY{l+m+mf}{0.40764331}\PY{p}{,}\PY{l+m+mf}{0.4118896}\PY{p}{,}\PY{l+m+mf}{0.4118896}\PY{p}{,}\PY{l+m+mf}{0.42250531}\PY{p}{,}\PY{l+m+mf}{0.42675159}\PY{p}{,}\PY{l+m+mf}{0.42887473}
\PY{p}{,}\PY{l+m+mf}{0.42887473}\PY{p}{,}\PY{l+m+mf}{0.43949045}\PY{p}{,}\PY{l+m+mf}{0.43949045}\PY{p}{,}\PY{l+m+mf}{0.44161359}\PY{p}{,}\PY{l+m+mf}{0.44585987}\PY{p}{,}\PY{l+m+mf}{0.45010616}
\PY{p}{,}\PY{l+m+mf}{0.45010616}\PY{p}{,}\PY{l+m+mf}{0.46072187}\PY{p}{,}\PY{l+m+mf}{0.46072187}\PY{p}{,}\PY{l+m+mf}{0.4670913}\PY{p}{,}\PY{l+m+mf}{0.48407643}\PY{p}{,}\PY{l+m+mf}{0.48407643}
\PY{p}{,}\PY{l+m+mf}{0.49044586}\PY{p}{,}\PY{l+m+mf}{0.49044586}\PY{p}{,}\PY{l+m+mf}{0.50106157}\PY{p}{,}\PY{l+m+mf}{0.50530786}\PY{p}{,}\PY{l+m+mf}{0.507431}\PY{p}{,}\PY{l+m+mf}{0.507431}
\PY{p}{,}\PY{l+m+mf}{0.50955414}\PY{p}{,}\PY{l+m+mf}{0.50955414}\PY{p}{,}\PY{l+m+mf}{0.51592357}\PY{p}{,}\PY{l+m+mf}{0.51592357}\PY{p}{,}\PY{l+m+mf}{0.51804671}\PY{p}{,}\PY{l+m+mf}{0.51804671}
\PY{p}{,}\PY{l+m+mf}{0.52016985}\PY{p}{,}\PY{l+m+mf}{0.52016985}\PY{p}{,}\PY{l+m+mf}{0.52441614}\PY{p}{,}\PY{l+m+mf}{0.52441614}\PY{p}{,}\PY{l+m+mf}{0.52653928}\PY{p}{,}\PY{l+m+mf}{0.52653928}
\PY{p}{,}\PY{l+m+mf}{0.52866242}\PY{p}{,}\PY{l+m+mf}{0.52866242}\PY{p}{,}\PY{l+m+mf}{0.53503185}\PY{p}{,}\PY{l+m+mf}{0.53503185}\PY{p}{,}\PY{l+m+mf}{0.53927813}\PY{p}{,}\PY{l+m+mf}{0.53927813}
\PY{p}{,}\PY{l+m+mf}{0.54140127}\PY{p}{,}\PY{l+m+mf}{0.54140127}\PY{p}{,}\PY{l+m+mf}{0.54564756}\PY{p}{,}\PY{l+m+mf}{0.54564756}\PY{p}{,}\PY{l+m+mf}{0.55838641}\PY{p}{,}\PY{l+m+mf}{0.55838641}
\PY{p}{,}\PY{l+m+mf}{0.56050955}\PY{p}{,}\PY{l+m+mf}{0.56050955}\PY{p}{,}\PY{l+m+mf}{0.56900212}\PY{p}{,}\PY{l+m+mf}{0.56900212}\PY{p}{,}\PY{l+m+mf}{0.57112527}\PY{p}{,}\PY{l+m+mf}{0.57112527}
\PY{p}{,}\PY{l+m+mf}{0.57537155}\PY{p}{,}\PY{l+m+mf}{0.57537155}\PY{p}{,}\PY{l+m+mf}{0.60509554}\PY{p}{,}\PY{l+m+mf}{0.60509554}\PY{p}{,}\PY{l+m+mf}{0.60721868}\PY{p}{,}\PY{l+m+mf}{0.60721868}
\PY{p}{,}\PY{l+m+mf}{0.61783439}\PY{p}{,}\PY{l+m+mf}{0.61783439}\PY{p}{,}\PY{l+m+mf}{0.62420382}\PY{p}{,}\PY{l+m+mf}{0.62420382}\PY{p}{,}\PY{l+m+mf}{0.62632696}\PY{p}{,}\PY{l+m+mf}{0.62632696}
\PY{p}{,}\PY{l+m+mf}{0.63694268}\PY{p}{,}\PY{l+m+mf}{0.63694268}\PY{p}{,}\PY{l+m+mf}{0.65392781}\PY{p}{,}\PY{l+m+mf}{0.65392781}\PY{p}{,}\PY{l+m+mf}{0.67303609}\PY{p}{,}\PY{l+m+mf}{0.67303609}
\PY{p}{,}\PY{l+m+mf}{0.67515924}\PY{p}{,}\PY{l+m+mf}{0.67515924}\PY{p}{,}\PY{l+m+mf}{0.67940552}\PY{p}{,}\PY{l+m+mf}{0.67940552}\PY{p}{,}\PY{l+m+mf}{0.68577495}\PY{p}{,}\PY{l+m+mf}{0.68577495}
\PY{p}{,}\PY{l+m+mf}{0.69639066}\PY{p}{,}\PY{l+m+mf}{0.69639066}\PY{p}{,}\PY{l+m+mf}{0.6985138}\PY{p}{,}\PY{l+m+mf}{0.6985138}\PY{p}{,}\PY{l+m+mf}{0.70700637}\PY{p}{,}\PY{l+m+mf}{0.70700637}
\PY{p}{,}\PY{l+m+mf}{0.7133758}\PY{p}{,}\PY{l+m+mf}{0.7133758}\PY{p}{,}\PY{l+m+mf}{0.71762208}\PY{p}{,}\PY{l+m+mf}{0.71762208}\PY{p}{,}\PY{l+m+mf}{0.72399151}\PY{p}{,}\PY{l+m+mf}{0.72399151}
\PY{p}{,}\PY{l+m+mf}{0.73460722}\PY{p}{,}\PY{l+m+mf}{0.73460722}\PY{p}{,}\PY{l+m+mf}{0.74309979}\PY{p}{,}\PY{l+m+mf}{0.74309979}\PY{p}{,}\PY{l+m+mf}{0.77494692}\PY{p}{,}\PY{l+m+mf}{0.77494692}
\PY{p}{,}\PY{l+m+mf}{0.78343949}\PY{p}{,}\PY{l+m+mf}{0.78343949}\PY{p}{,}\PY{l+m+mf}{0.81953291}\PY{p}{,}\PY{l+m+mf}{0.81953291}\PY{p}{,}\PY{l+m+mf}{0.82165605}\PY{p}{,}\PY{l+m+mf}{0.82165605}
\PY{p}{,}\PY{l+m+mf}{0.82377919}\PY{p}{,}\PY{l+m+mf}{0.82377919}\PY{p}{,}\PY{l+m+mf}{0.83014862}\PY{p}{,}\PY{l+m+mf}{0.83014862}\PY{p}{,}\PY{l+m+mf}{0.83227176}\PY{p}{,}\PY{l+m+mf}{0.83227176}
\PY{p}{,}\PY{l+m+mf}{0.84288747}\PY{p}{,}\PY{l+m+mf}{0.84288747}\PY{p}{,}\PY{l+m+mf}{0.86836518}\PY{p}{,}\PY{l+m+mf}{0.86836518}\PY{p}{,}\PY{l+m+mf}{0.87261146}\PY{p}{,}\PY{l+m+mf}{0.87473461}
\PY{p}{,}\PY{l+m+mf}{0.87685775}\PY{p}{,}\PY{l+m+mf}{0.87898089}\PY{p}{,}\PY{l+m+mf}{0.88322718}\PY{p}{,}\PY{l+m+mf}{0.88747346}\PY{p}{,}\PY{l+m+mf}{0.8895966}\PY{p}{,}\PY{l+m+mf}{0.89171975}
\PY{p}{,}\PY{l+m+mf}{0.89808917}\PY{p}{,}\PY{l+m+mf}{0.90021231}\PY{p}{,}\PY{l+m+mf}{0.91295117}\PY{p}{,}\PY{l+m+mf}{0.91932059}\PY{p}{,}\PY{l+m+mf}{0.92781316}\PY{p}{,}\PY{l+m+mf}{0.93205945}
\PY{p}{,}\PY{l+m+mf}{0.9447983}\PY{p}{,}\PY{l+m+mf}{0.94904459}\PY{p}{,}\PY{l+m+mf}{0.95329087}\PY{p}{,}\PY{l+m+mf}{0.96602972}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}

\PY{n}{fprStr} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{n}{tprStr} \PY{o}{=} \PY{p}{[}\PY{p}{]}


\PY{n}{fprStr} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ }\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n+nb}{str}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZob{}0:.2f\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{i}\PY{p}{)}\PY{p}{)} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{fpr}\PY{p}{)}
\PY{n}{tprStr} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ }\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n+nb}{str}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZob{}0:.2f\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{i}\PY{p}{)}\PY{p}{)} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{tpr}\PY{p}{)}



\PY{k}{with} \PY{n+nb}{open}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{roc.txt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{w}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{k}{as} \PY{n}{curve}\PY{p}{:}
    \PY{c+c1}{\PYZsh{}for listitem in places:}
    \PY{n}{curve}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{n}{fprStr}\PY{o}{+}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{curve}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{n}{tprStr}\PY{p}{)}

\PY{c+c1}{\PYZsh{} print(fpr)}
\PY{c+c1}{\PYZsh{} print(tpr)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{finish}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{fpr}\PY{p}{,}\PY{n}{tpr}\PY{p}{)} 
\PY{n}{plt}\PY{o}{.}\PY{n}{axis}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)} 
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{False Positive Rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} 
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{True Positive Rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} 
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
\PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline

\PY{n}{acc} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{n}{val\PYZus{}acc} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{n}{loss} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{n}{val\PYZus{}loss} \PY{o}{=} \PY{p}{[}\PY{p}{]}

\PY{k}{with} \PY{n+nb}{open}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{results/history.txt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{k}{as} \PY{n}{filehandle}\PY{p}{:}
    \PY{n}{accStr} \PY{o}{=} \PY{n}{filehandle}\PY{o}{.}\PY{n}{readline}\PY{p}{(}\PY{p}{)}
    \PY{n}{val\PYZus{}accStr} \PY{o}{=} \PY{n}{filehandle}\PY{o}{.}\PY{n}{readline}\PY{p}{(}\PY{p}{)}
    \PY{n}{lossStr} \PY{o}{=} \PY{n}{filehandle}\PY{o}{.}\PY{n}{readline}\PY{p}{(}\PY{p}{)}
    \PY{n}{val\PYZus{}lossStr} \PY{o}{=} \PY{n}{filehandle}\PY{o}{.}\PY{n}{readline}\PY{p}{(}\PY{p}{)}

\PY{n}{data} \PY{o}{=} \PY{n}{accStr}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}
\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{data}\PY{p}{:}
    \PY{n}{acc}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n+nb}{float}\PY{p}{(}\PY{n}{i}\PY{p}{)}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{acc}\PY{p}{)}

\PY{n}{data} \PY{o}{=} \PY{n}{val\PYZus{}accStr}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}
\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{data}\PY{p}{:}
    \PY{n}{val\PYZus{}acc}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n+nb}{float}\PY{p}{(}\PY{n}{i}\PY{p}{)}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{val\PYZus{}acc}\PY{p}{)}
    
\PY{n}{data} \PY{o}{=} \PY{n}{lossStr}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}
\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{data}\PY{p}{:}
    \PY{n}{loss}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n+nb}{float}\PY{p}{(}\PY{n}{i}\PY{p}{)}\PY{p}{)}

\PY{n}{data} \PY{o}{=} \PY{n}{val\PYZus{}lossStr}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}
\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{data}\PY{p}{:}
    \PY{n}{val\PYZus{}loss}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n+nb}{float}\PY{p}{(}\PY{n}{i}\PY{p}{)}\PY{p}{)}

\PY{n}{epochs} \PY{o}{=} \PY{p}{[}\PY{n}{i} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{acc}\PY{p}{)}\PY{p}{)}\PY{p}{]}

\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{epochs}\PY{p}{,} \PY{n}{acc}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Training}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{epochs}\PY{p}{,} \PY{n}{val\PYZus{}acc}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Validation}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Accuracy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}

\PY{n}{fpr} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{n}{tpr} \PY{o}{=} \PY{p}{[}\PY{p}{]}

\PY{c+c1}{\PYZsh{} open file and read the content in a list}
\PY{k}{with} \PY{n+nb}{open}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{results/roc.txt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{k}{as} \PY{n}{filehandle}\PY{p}{:}
    \PY{n}{fprStr} \PY{o}{=} \PY{n}{filehandle}\PY{o}{.}\PY{n}{readline}\PY{p}{(}\PY{p}{)}
    \PY{n}{tprStr} \PY{o}{=} \PY{n}{filehandle}\PY{o}{.}\PY{n}{readline}\PY{p}{(}\PY{p}{)}

\PY{n}{data} \PY{o}{=} \PY{n}{fprStr}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}
\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{data}\PY{p}{:}
    \PY{n}{fpr}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n+nb}{float}\PY{p}{(}\PY{n}{i}\PY{p}{)}\PY{p}{)}

\PY{n}{data} \PY{o}{=} \PY{n}{tprStr}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}
\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{data}\PY{p}{:}
    \PY{n}{tpr}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n+nb}{float}\PY{p}{(}\PY{n}{i}\PY{p}{)}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{fpr}\PY{p}{,}\PY{n}{tpr}\PY{p}{)} 
\PY{n}{plt}\PY{o}{.}\PY{n}{axis}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)} 
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{False Positive Rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} 
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{True Positive Rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} 
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{1}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{tensorflow} \PY{k}{as} \PY{n+nn}{tf}

\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{models} \PY{k}{import} \PY{n}{Sequential}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers} \PY{k}{import} \PY{n}{Convolution2D}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers} \PY{k}{import} \PY{n}{MaxPooling2D}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers} \PY{k}{import} \PY{n}{Input}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers} \PY{k}{import} \PY{n}{Flatten}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers} \PY{k}{import} \PY{n}{Dense}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers} \PY{k}{import} \PY{n}{BatchNormalization}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers} \PY{k}{import} \PY{n}{Dropout}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras} \PY{k}{import} \PY{n}{applications}

\PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{models} \PY{k}{import} \PY{n}{Model}

\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Started!}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}


\PY{k}{def} \PY{n+nf}{createModel}\PY{p}{(}\PY{p}{)}\PY{p}{:}
    \PY{n}{model}\PY{o}{=}\PY{n}{tf}\PY{o}{.}\PY{n}{keras}\PY{o}{.}\PY{n}{Sequential}\PY{p}{(}\PY{p}{)}   \PY{c+c1}{\PYZsh{} Intialializing CNN}

    \PY{n}{shape} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{244}\PY{p}{,} \PY{l+m+mi}{244}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{)}
    \PY{n}{vggModel}\PY{o}{=}\PY{n}{tf}\PY{o}{.}\PY{n}{keras}\PY{o}{.}\PY{n}{applications}\PY{o}{.}\PY{n}{VGG16}\PY{p}{(}\PY{n}{input\PYZus{}shape}\PY{o}{=}\PY{n}{shape}\PY{p}{,}
                                               \PY{n}{include\PYZus{}top}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,}
                                               \PY{n}{weights}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{imagenet}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{vggModel}\PY{o}{.}\PY{n}{trainable} \PY{o}{=} \PY{k+kc}{False}
    \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{vggModel}\PY{p}{)}

    \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Flatten}\PY{p}{(}\PY{p}{)}\PY{p}{)} 

    \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dense}\PY{p}{(}\PY{l+m+mi}{4096}\PY{p}{,}\PY{n}{activation} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{relu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
    \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dense}\PY{p}{(}\PY{l+m+mi}{4096}\PY{p}{,}\PY{n}{activation} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{relu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}  
    \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dense}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{activation} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{softmax}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}

    \PY{n}{model}\PY{o}{.}\PY{n}{compile}\PY{p}{(}\PY{n}{optimizer} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{adam}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{loss} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{binary\PYZus{}crossentropy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{metrics} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{accuracy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
    
    \PY{k}{return} \PY{n}{model}


\PY{n}{classifier} \PY{o}{=} \PY{n}{createModel}\PY{p}{(}\PY{p}{)}

\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{preprocessing}\PY{n+nn}{.}\PY{n+nn}{image} \PY{k}{import} \PY{n}{ImageDataGenerator}

\PY{n}{test\PYZus{}datagen} \PY{o}{=} \PY{n}{ImageDataGenerator}\PY{p}{(}\PY{n}{rescale}\PY{o}{=}\PY{l+m+mf}{1.}\PY{o}{/}\PY{l+m+mi}{255}\PY{p}{)}

\PY{n}{path}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{F:/Workspace/Test/input/validation}\PY{l+s+s2}{\PYZdq{}}

\PY{n}{batchSize} \PY{o}{=} \PY{l+m+mi}{16}


\PY{n}{validSet} \PY{o}{=} \PY{n}{test\PYZus{}datagen}\PY{o}{.}\PY{n}{flow\PYZus{}from\PYZus{}directory}\PY{p}{(}\PY{n}{path}\PY{p}{,}
                                              \PY{n}{target\PYZus{}size}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{244}\PY{p}{,}\PY{l+m+mi}{244}\PY{p}{)}\PY{p}{,}
                                              \PY{n}{batch\PYZus{}size}\PY{o}{=}\PY{n}{batchSize}\PY{p}{,}
                                              \PY{n}{shuffle}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,}
                                              \PY{n}{class\PYZus{}mode}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{binary}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}


\PY{n}{checkpoint\PYZus{}path} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{F:/Workspace/Test/checkpoints/old/cpOld.ckpt}\PY{l+s+s2}{\PYZdq{}}
\PY{c+c1}{\PYZsh{}checkpoint\PYZus{}dir = os.path.dirname(checkpoint\PYZus{}path)}

\PY{n}{steps} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{validSet}\PY{o}{.}\PY{n}{classes}\PY{p}{)} \PY{o}{/} \PY{n}{batchSize}                   

\PY{c+c1}{\PYZsh{}loss, acc = classifier.evaluate\PYZus{}generator(generator=validSet,steps=steps)}
\PY{c+c1}{\PYZsh{}print(\PYZdq{}Untrained model, accuracy: \PYZob{}:5.2f\PYZcb{}\PYZpc{}\PYZdq{}.format(100*acc))}

\PY{n}{classifier}\PY{o}{.}\PY{n}{load\PYZus{}weights}\PY{p}{(}\PY{n}{checkpoint\PYZus{}path}\PY{p}{)}
\PY{n}{loss}\PY{p}{,} \PY{n}{acc} \PY{o}{=} \PY{n}{classifier}\PY{o}{.}\PY{n}{evaluate\PYZus{}generator}\PY{p}{(}\PY{n}{generator}\PY{o}{=}\PY{n}{validSet}\PY{p}{,}\PY{n}{steps}\PY{o}{=}\PY{n}{steps}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Loaded model, accuracy: }\PY{l+s+si}{\PYZob{}:5.2f\PYZcb{}}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{l+m+mi}{100}\PY{o}{*}\PY{n}{acc}\PY{p}{)}\PY{p}{)}

\PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
\PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline

\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{roc\PYZus{}curve}\PY{p}{,}\PY{n}{roc\PYZus{}auc\PYZus{}score}

\PY{n}{trueValues} \PY{o}{=} \PY{n}{validSet}\PY{o}{.}\PY{n}{classes}
\PY{n}{predSteps} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{validSet}\PY{o}{.}\PY{n}{classes}\PY{p}{)} \PY{o}{/} \PY{n}{batchSize}
\PY{n}{predictions} \PY{o}{=} \PY{n}{classifier}\PY{o}{.}\PY{n}{predict\PYZus{}generator}\PY{p}{(}\PY{n}{validSet}\PY{p}{,}\PY{n}{steps} \PY{o}{=} \PY{n}{predSteps}\PY{p}{,}\PY{n}{verbose}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}

\PY{n}{fpr}\PY{p}{,} \PY{n}{tpr}\PY{p}{,} \PY{n}{thresholds} \PY{o}{=} \PY{n}{roc\PYZus{}curve} \PY{p}{(}\PY{n}{trueValues} \PY{p}{,} \PY{n}{predictions}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{fpr}\PY{p}{,}\PY{n}{tpr}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{axis}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{False Positive Rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} 
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{True Positive Rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} 
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Using TensorFlow backend.
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Started!
Found 382 images belonging to 2 classes.
Untrained model, accuracy: 50.00\%
Loaded model, accuracy: 50.00\%
24/23 [==============================] - 184s 8s/step
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{DataMining_files/DataMining_11_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
\PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline

\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{auc}

\PY{n}{fpr} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{n}{tpr} \PY{o}{=} \PY{p}{[}\PY{p}{]}

\PY{c+c1}{\PYZsh{} open file and read the content in a list}
\PY{k}{with} \PY{n+nb}{open}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{checkpoints/results/roc.txt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{k}{as} \PY{n}{filehandle}\PY{p}{:}
    \PY{n}{fprStr} \PY{o}{=} \PY{n}{filehandle}\PY{o}{.}\PY{n}{readline}\PY{p}{(}\PY{p}{)}
    \PY{n}{tprStr} \PY{o}{=} \PY{n}{filehandle}\PY{o}{.}\PY{n}{readline}\PY{p}{(}\PY{p}{)}

\PY{n}{data} \PY{o}{=} \PY{n}{fprStr}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}
\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{data}\PY{p}{:}
    \PY{n}{fpr}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n+nb}{float}\PY{p}{(}\PY{n}{i}\PY{p}{)}\PY{p}{)}

\PY{n}{data} \PY{o}{=} \PY{n}{tprStr}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}
\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{data}\PY{p}{:}
    \PY{n}{tpr}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n+nb}{float}\PY{p}{(}\PY{n}{i}\PY{p}{)}\PY{p}{)}

\PY{n+nb}{print}\PY{p}{(}\PY{n}{auc}\PY{p}{(}\PY{n}{fpr}\PY{p}{,} \PY{n}{tpr}\PY{p}{)}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{fpr}\PY{p}{,}\PY{n}{tpr}\PY{p}{)} 
\PY{n}{plt}\PY{o}{.}\PY{n}{axis}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)} 
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{False Positive Rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} 
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{True Positive Rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} 
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
\PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline

\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{auc}

\PY{n}{fpr} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{n}{tpr} \PY{o}{=} \PY{p}{[}\PY{p}{]}

\PY{c+c1}{\PYZsh{} open file and read the content in a list}
\PY{k}{with} \PY{n+nb}{open}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{checkpoints/results/rocOld.txt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{k}{as} \PY{n}{filehandle}\PY{p}{:}
    \PY{n}{fprStr} \PY{o}{=} \PY{n}{filehandle}\PY{o}{.}\PY{n}{readline}\PY{p}{(}\PY{p}{)}
    \PY{n}{tprStr} \PY{o}{=} \PY{n}{filehandle}\PY{o}{.}\PY{n}{readline}\PY{p}{(}\PY{p}{)}

\PY{n}{data} \PY{o}{=} \PY{n}{fprStr}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}
\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{data}\PY{p}{:}
    \PY{n}{fpr}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n+nb}{float}\PY{p}{(}\PY{n}{i}\PY{p}{)}\PY{p}{)}

\PY{n}{data} \PY{o}{=} \PY{n}{tprStr}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}
\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{data}\PY{p}{:}
    \PY{n}{tpr}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n+nb}{float}\PY{p}{(}\PY{n}{i}\PY{p}{)}\PY{p}{)}

\PY{n+nb}{print}\PY{p}{(}\PY{n}{auc}\PY{p}{(}\PY{n}{fpr}\PY{p}{,} \PY{n}{tpr}\PY{p}{)}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{fpr}\PY{p}{,}\PY{n}{tpr}\PY{p}{)} 
\PY{n}{plt}\PY{o}{.}\PY{n}{axis}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)} 
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{False Positive Rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} 
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{True Positive Rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} 
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{2}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
\PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline

\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{auc}

\PY{n}{fpr} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{n}{tpr} \PY{o}{=} \PY{p}{[}\PY{p}{]}

\PY{c+c1}{\PYZsh{} open file and read the content in a list}
\PY{k}{with} \PY{n+nb}{open}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{checkpoints/results/roc.txt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{k}{as} \PY{n}{filehandle}\PY{p}{:}
    \PY{n}{fprStr} \PY{o}{=} \PY{n}{filehandle}\PY{o}{.}\PY{n}{readline}\PY{p}{(}\PY{p}{)}
    \PY{n}{tprStr} \PY{o}{=} \PY{n}{filehandle}\PY{o}{.}\PY{n}{readline}\PY{p}{(}\PY{p}{)}

\PY{n}{data} \PY{o}{=} \PY{n}{fprStr}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}
\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{data}\PY{p}{:}
    \PY{n}{fpr}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n+nb}{float}\PY{p}{(}\PY{n}{i}\PY{p}{)}\PY{p}{)}

\PY{n}{data} \PY{o}{=} \PY{n}{tprStr}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}
\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{data}\PY{p}{:}
    \PY{n}{tpr}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n+nb}{float}\PY{p}{(}\PY{n}{i}\PY{p}{)}\PY{p}{)}

\PY{n+nb}{print}\PY{p}{(}\PY{n}{auc}\PY{p}{(}\PY{n}{fpr}\PY{p}{,} \PY{n}{tpr}\PY{p}{)}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{fpr}\PY{p}{,}\PY{n}{tpr}\PY{p}{)} 
\PY{n}{plt}\PY{o}{.}\PY{n}{axis}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)} 
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{False Positive Rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} 
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{True Positive Rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} 
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
0.5054000000000001
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{DataMining_files/DataMining_14_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{8}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{tensorflow} \PY{k}{as} \PY{n+nn}{tf}

\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{models} \PY{k}{import} \PY{n}{Sequential}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers} \PY{k}{import} \PY{n}{Convolution2D}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers} \PY{k}{import} \PY{n}{MaxPooling2D}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers} \PY{k}{import} \PY{n}{Input}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers} \PY{k}{import} \PY{n}{Flatten}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers} \PY{k}{import} \PY{n}{Dense}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers} \PY{k}{import} \PY{n}{BatchNormalization}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers} \PY{k}{import} \PY{n}{Dropout}
\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras} \PY{k}{import} \PY{n}{applications}

\PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{models} \PY{k}{import} \PY{n}{Model}

\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Started!}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{batchSize} \PY{o}{=} \PY{l+m+mi}{16}



\PY{n}{classifier} \PY{o}{=} \PY{n}{tf}\PY{o}{.}\PY{n}{keras}\PY{o}{.}\PY{n}{models}\PY{o}{.}\PY{n}{load\PYZus{}model}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{F:/Workspace/Test/checkpoints/myModel.h5}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{classifier}\PY{o}{.}\PY{n}{summary}\PY{p}{(}\PY{p}{)}

\PY{k+kn}{from} \PY{n+nn}{tensorflow}\PY{n+nn}{.}\PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{preprocessing}\PY{n+nn}{.}\PY{n+nn}{image} \PY{k}{import} \PY{n}{ImageDataGenerator}

\PY{n}{test\PYZus{}datagen} \PY{o}{=} \PY{n}{ImageDataGenerator}\PY{p}{(}\PY{n}{rescale}\PY{o}{=}\PY{l+m+mf}{1.}\PY{o}{/}\PY{l+m+mi}{255}\PY{p}{)}

\PY{n}{path}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{F:/Workspace/Test/input/validation}\PY{l+s+s2}{\PYZdq{}}

\PY{n}{validSet} \PY{o}{=} \PY{n}{test\PYZus{}datagen}\PY{o}{.}\PY{n}{flow\PYZus{}from\PYZus{}directory}\PY{p}{(}\PY{n}{path}\PY{p}{,}
                                              \PY{n}{target\PYZus{}size}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{244}\PY{p}{,}\PY{l+m+mi}{244}\PY{p}{)}\PY{p}{,}
                                              \PY{n}{batch\PYZus{}size}\PY{o}{=}\PY{n}{batchSize}\PY{p}{,}
                                              \PY{n}{shuffle}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,}
                                              \PY{n}{class\PYZus{}mode}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{binary}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}


\PY{c+c1}{\PYZsh{}checkpoint\PYZus{}path = \PYZdq{}F:/Workspace/Test/checkpoints/cp2.ckpt\PYZdq{}}
\PY{c+c1}{\PYZsh{}checkpoint\PYZus{}dir = os.path.dirname(checkpoint\PYZus{}path)}
                              
\PY{c+c1}{\PYZsh{}loss, acc = classifier.evaluate\PYZus{}generator(generator=validSet,steps=steps)}
\PY{c+c1}{\PYZsh{}print(\PYZdq{}Untrained model, accuracy: \PYZob{}:5.2f\PYZcb{}\PYZpc{}\PYZdq{}.format(100*acc))}
\PY{n}{predSteps} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{validSet}\PY{o}{.}\PY{n}{classes}\PY{p}{)} \PY{o}{/} \PY{n}{batchSize}
\PY{c+c1}{\PYZsh{}classifier.load\PYZus{}weights(checkpoint\PYZus{}path)}
\PY{n}{loss}\PY{p}{,} \PY{n}{acc} \PY{o}{=} \PY{n}{classifier}\PY{o}{.}\PY{n}{evaluate\PYZus{}generator}\PY{p}{(}\PY{n}{generator}\PY{o}{=}\PY{n}{validSet}\PY{p}{,}\PY{n}{steps}\PY{o}{=}\PY{n}{predSteps}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Loaded model, accuracy: }\PY{l+s+si}{\PYZob{}:5.2f\PYZcb{}}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{l+m+mi}{100}\PY{o}{*}\PY{n}{acc}\PY{p}{)}\PY{p}{)}

\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{roc\PYZus{}curve}\PY{c+c1}{\PYZsh{},roc\PYZus{}auc\PYZus{}score}

\PY{n}{trueValues} \PY{o}{=} \PY{n}{validSet}\PY{o}{.}\PY{n}{classes}

\PY{n}{predictions} \PY{o}{=} \PY{n}{classifier}\PY{o}{.}\PY{n}{predict\PYZus{}generator}\PY{p}{(}\PY{n}{validSet}\PY{p}{,}\PY{n}{steps} \PY{o}{=} \PY{n}{predSteps}\PY{p}{,}\PY{n}{verbose}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}

\PY{n}{fpr}\PY{p}{,} \PY{n}{tpr}\PY{p}{,} \PY{n}{thresholds} \PY{o}{=} \PY{n}{roc\PYZus{}curve} \PY{p}{(}\PY{n}{trueValues} \PY{p}{,} \PY{n}{predictions}\PY{p}{)}

\PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
\PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline

\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{fpr}\PY{p}{,}\PY{n}{tpr}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{axis}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{False Positive Rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} 
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{True Positive Rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} 
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Started!
Model: "sequential"
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Layer (type)                 Output Shape              Param \#
=================================================================
vgg16 (Model)                (None, 7, 7, 512)         14714688
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
flatten (Flatten)            (None, 25088)             0
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
dense (Dense)                (None, 4096)              102764544
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
dense\_1 (Dense)              (None, 4096)              16781312
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
dense\_2 (Dense)              (None, 1)                 4097
=================================================================
Total params: 134,264,641
Trainable params: 134,264,641
Non-trainable params: 0
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Found 382 images belonging to 2 classes.
Loaded model, accuracy: 50.00\%
24/23 - 156s
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{DataMining_files/DataMining_15_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]

\end{Verbatim}
\end{tcolorbox}


    % Add a bibliography block to the postdoc
    
    
    
\end{document}
